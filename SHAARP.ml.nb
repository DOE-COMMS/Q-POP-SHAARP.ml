(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    378640,       7929]
NotebookOptionsPosition[    377709,       7903]
NotebookOutlinePosition[    378184,       7921]
CellTagsIndexPosition[    378141,       7918]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Initialization",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.8959329631164618`*^9, 
  3.895932965909975*^9}},ExpressionUUID->"441924d6-3b8e-4bd4-8fa6-\
0941648c2c7b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<setup.nb\>\""}], 
    "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setupvar", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8863764175259113`*^9, 3.8863764216510215`*^9}, 
   3.8863766499202127`*^9, 3.8864455607318544`*^9, 3.887895488853596*^9, {
   3.887896034438848*^9, 3.8878960439160757`*^9}, {3.889436106460884*^9, 
   3.8894361315889654`*^9}, {3.8894361873976126`*^9, 3.88943619269838*^9}, {
   3.89102444959268*^9, 3.891024450746577*^9}, {3.89305939105934*^9, 
   3.8930593986154356`*^9}, 3.893059461698475*^9, {3.8930644547510796`*^9, 
   3.893064472349676*^9}, {3.893064510080668*^9, 3.893064522229964*^9}, {
   3.893191509709758*^9, 3.893191517223592*^9}, {3.893192189074219*^9, 
   3.893192204514889*^9}, 3.893193179948883*^9, {3.8931939064949512`*^9, 
   3.8931939312531705`*^9}, 3.8933405442081523`*^9, 3.8933481622867684`*^9, {
   3.8933507093480396`*^9, 3.893350715957938*^9}, {3.894586300088585*^9, 
   3.8945863019774375`*^9}, {3.8945882385294175`*^9, 3.8945882396429615`*^9}, 
   3.895364685360523*^9, 3.895837732757901*^9, {3.8958382367167573`*^9, 
   3.8958382509804587`*^9}, {3.895862888181453*^9, 3.895862899403054*^9}, {
   3.8958714652797155`*^9, 3.8958714808134613`*^9}, {3.895871577983863*^9, 
   3.8958716149822598`*^9}, {3.895881111608961*^9, 3.8958811205978346`*^9}, {
   3.8959239658297596`*^9, 3.895923966325376*^9}, 3.8959423773480606`*^9, {
   3.896314653348934*^9, 3.896314657267294*^9}, 3.8963154455605087`*^9, {
   3.896321435583887*^9, 3.8963214612888904`*^9}, {3.897014237722165*^9, 
   3.897014241214029*^9}, {3.8970165009005947`*^9, 3.897016502144909*^9}, {
   3.8970969729877863`*^9, 3.8970969747356415`*^9}, {3.8971742747549467`*^9, 
   3.8971742987739334`*^9}, {3.8971743546206465`*^9, 
   3.8971743601042366`*^9}, {3.8972624999508963`*^9, 3.89726250567898*^9}, {
   3.897262744722416*^9, 3.8972627684770613`*^9}, {3.8972632772311325`*^9, 
   3.8972632852568636`*^9}, {3.8972633516738973`*^9, 
   3.8972633541172123`*^9}, {3.897263634613264*^9, 3.897263650408495*^9}, {
   3.8972639453176775`*^9, 3.8972639464912057`*^9}, {3.897264054835474*^9, 
   3.897264063685416*^9}, {3.8972641236852856`*^9, 3.8972641640741763`*^9}, {
   3.897264334170711*^9, 3.897264375822837*^9}, {3.897264409445538*^9, 
   3.897264410986657*^9}, 3.8972647577955017`*^9, 3.897265056538562*^9, {
   3.8972657392507453`*^9, 3.897265739430617*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"0937ff5c-ef37-4c7e-9f0b-71353001cec0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "run", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"setupvar", "\[NotEqual]", "1"}], "||", 
     RowBox[{"!", 
      RowBox[{"ValueQ", "[", "setupvar", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<Please Evaluate the setup.nb first!\>\"", ",", "Bold", ",", "Red",
         ",", "32"}], "]"}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogoExists", " ", "=", " ", 
   RowBox[{"FileExistsQ", "[", "\"\<Logo.png\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"LogoExists", " ", ",", 
    RowBox[{
     RowBox[{"Logo", "=", 
      RowBox[{"Image", "[", 
       RowBox[{
        RowBox[{"Import", "[", "\"\<Logo.png\>\"", "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "550"}]}], "]"}]}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"progress", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"equByteLimit", "=", 
    SuperscriptBox["10", "5"]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "analytical", " ", "expression", " ", "exceeds", " ", "this", 
     " ", "size"}], ",", " ", 
    RowBox[{
    "it", " ", "will", " ", "hide", " ", "in", " ", "case", " ", "of", " ", 
     "crash"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"mtop", ",", "mlayer", ",", "mbot"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mtop", "=", 
   RowBox[{"setMater", "@", 
    RowBox[{"Air", "[", "]"}]}]}], ";", 
  RowBox[{"extMater", "@", "mtop"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlayer", "=", 
   RowBox[{"setMater", "@", 
    RowBox[{"LiNbO3", "[", "]"}]}]}], ";", 
  RowBox[{"extMater", "@", "mlayer"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mbot", "=", 
    RowBox[{"setMater", "@", 
     RowBox[{"Air", "[", "]"}]}]}], ";", 
   RowBox[{"extMater", "@", "mbot"}], ";"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", 
   RowBox[{
   "max", " ", "number", " ", "of", " ", "layers", " ", "in", " ", "the", " ",
     "system"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxmaterialnumber", "=", "10"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "a", " ", "default", " ", "list", " ", "to", " ", "store", " ", "all", 
     " ", "materials", " ", "for", " ", "the", " ", "current", " ", 
     "system"}], ";", " ", 
    RowBox[{
    "set", " ", "top", " ", "and", " ", "bottom", " ", "to", " ", "be", " ", 
     "air", " ", "by", " ", "default"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allmaterials", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mbot", ",", "mlayer"}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"mtop", ",", 
        RowBox[{"maxmaterialnumber", "-", "2"}]}], "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"run", ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProgressIndicator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "progress", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "100"}], "}"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"1000", ",", "30"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<     \>\"", ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "progress", "]"}], ",", "22", ",", 
             RowBox[{"FontFamily", "->", "\"\<Helvetica\>\""}]}], "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<% Completed\>\"", ",", "22", ",", 
             RowBox[{"FontFamily", "->", "\"\<Helvetica\>\""}]}], "]"}]}], 
          "}"}], "]"}]}], "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Framed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"RawBoxes", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToBoxes", "[", "#", "]"}], "/.", 
           RowBox[{"MapAt", "[", 
            RowBox[{"RuleCondition", ",", 
             RowBox[{"DownValues", "[", "Manipulate`ManipulateBoxes", "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}], "/.", 
          RowBox[{
           RowBox[{"FEPrivate`FrontEndResource", "[", 
            RowBox[{"\"\<FEBitmaps\>\"", ",", "\"\<UpdateIcon\>\""}], "]"}], 
           "\[RuleDelayed]", "\[IndentingNewLine]", 
           RowBox[{"ToBoxes", "@", 
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Green", ",", 
                RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1.8", ",", "0.7"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Inset", "[", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<Update\>\"", ",", "Black", ",", 
                   RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
                   RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"Scaled", "[", ".27", "]"}]}], ",", 
                   RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}]}]}], "]"}], 
        "&"}], "@", "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Clear", "[", 
           RowBox[{"wavL", ",", "wavNL"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"userguide", "=", 
           RowBox[{"Column", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"\"\<\>\"", ",", "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "Style", "[", 
                   "\"\<Welcome to \
\[Sharp]SHAARP.\!\(\*StyleBox[\\\"ml\\\",FontSlant->\\\"Italic\\\"]\) !\>\"", 
                   "]"}], "}"}], ",", 
                 RowBox[{"BaseStyle", "->", "\"\<Title\>\""}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
               "Style", "[", 
                "\"\<\[Sharp]SHAARP.\!\(\*StyleBox[\\\"ml\\\",FontSlant->\\\"\
Italic\\\"]\) is an open-source package for deriving and simulating reflected \
and transmitted optical second harmonic generation (SHG) of slab and \
multilayer systems. Optical SHG describes the process where two photons of \
frequency interact with one or more nonlinear media (crystals) to create a \
photon at 2\[Omega], so called the SHG process.\>\"", "]"}], ",", 
               "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "Style", "[", 
                  "\"\<This package builds in the most general approach to \
both analytically and numerically solving the SHG response of crystals with \
arbitrary crystal symmetry, arbitrary orientation, and a complex dielectric \
function (complex refractive indices).\>\"", "]"}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "Style", "[", 
                   "\"\<Open \[Sharp]SHAARP.ml.nb in the Mathematica\
\[RegisteredTrademark] software on your computer\>\"", "]"}], "}"}], ",", 
                 RowBox[{"BaseStyle", "\[Rule]", "\"\<Section\>\""}]}], "]"}],
                ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", "\"\<1. From the menu, \>\"", "]"}], 
                  ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<Evaluate\>\"", ",", 
                    RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}], 
                  ",", 
                  RowBox[{"Style", "[", "\"\< -> \>\"", "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<Evaluate Notebook\>\"", ",", 
                    RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}]}],
                  "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "Style", "[", 
                  "\"\<    Note: This process will clear out all the \
definitions from other notebooks and enable the Notation package for the \
analytical solutions.\>\"", "]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "Style", "[", 
                  "\"\<2. After a few seconds waiting time for \
initialization, you will see the main panel\>\"", "]"}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Use the 'Functionality' control on the control panel to \
the left to set material properties and then view the desired output in the \
display panel.\\nIn order to update figures in the display panel, you must \
press any of the three 'Update' button in green to the top right.\>\"", ",", 
                 "20"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<\>\"", ",", "30"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Style", "[", "\"\<More Resources\>\"", "]"}], 
                  "}"}], ",", 
                 RowBox[{"BaseStyle", "\[Rule]", "\"\<Section\>\""}]}], "]"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "Style", "[", 
                   "\"\<For detailed information of \[Sharp]SHAARP.ml, please \
refer to the \>\"", "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Hyperlink", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", "\"\<GitHub\>\"", "]"}], ",", 
                    "\"\<https://github.com/bzw133/SHAARP.ml\>\""}], "]"}], 
                  ",", "\"\<, \>\"", ",", "\[IndentingNewLine]", 
                  RowBox[{"Hyperlink", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", "\"\<manual\>\"", "]"}], ",", 
                    "\"\<https://shaarpml.readthedocs.io/en/latest/\>\""}], 
                   "]"}], ",", "\"\<, \>\"", ",", "\[IndentingNewLine]", 
                  RowBox[{"Hyperlink", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", "\"\<tutorial video\>\"", "]"}], 
                    ",", "\"\<https://www.youtube.com/watch?v=YiKRm6i7kNs\>\"\
"}], "]"}], ",", 
                  RowBox[{"Style", "[", "\"\<, and \>\"", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Hyperlink", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", "\"\<FAQ\>\"", "]"}], ",", 
                    "\"\<https://shaarpml.readthedocs.io/en/latest/FAQ/\>\""}]\
, "]"}], ",", "\"\<.\>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
               "\"\<\>\"", ",", "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "Style", "[", 
                   "\"\<\[Sharp]SHAARP for single interface, \
\[Sharp]SHAARP.si : \>\"", "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Hyperlink", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", "\"\<GitHub\>\"", "]"}], ",", 
                    "\"\<https://github.com/Rui-Zu/SHAARP\>\""}], "]"}], ",", 
                  RowBox[{"Style", "[", "\"\<, \>\"", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Hyperlink", "[", 
                   RowBox[{
                    RowBox[{
                    "Style", "[", "\"\<\[Sharp]SHAARP.si manual\>\"", "]"}], 
                    ",", "\"\<https://shaarp.readthedocs.io/en/latest/\>\""}],
                    "]"}], ",", "\"\<.\>\""}], "}"}], "]"}], ",", 
               "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "Style", "[", 
                   "\"\<If you used \[Sharp]SHAARP for your publications, \
please kindly cite us:  \>\"", "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Hyperlink", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", "\"\<\[Sharp]SHAARP.ml\>\"", "]"}], 
                    ",", "\"\<https://arxiv.org/abs/2307.01368\>\""}], "]"}], 
                  ",", 
                  RowBox[{"Style", "[", "\"\<, \>\"", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Hyperlink", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", "\"\<\[Sharp]SHAARP.si\>\"", "]"}], 
                    ",", "\"\<https://www.nature.com/articles/s41524-022-\
00930-4\>\""}], "]"}], ",", "\"\<.\>\""}], "}"}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"Background", "->", "White"}], ",", 
             RowBox[{"Alignment", "->", "Left"}], ",", 
             RowBox[{"BaseStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"FontFamily", "->", "\"\<Franklin Gothic\>\""}], ",", 
                RowBox[{"FontSize", "->", "18"}]}], "}"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"(*", "Preprocessing", "*)"}], "Chapter"], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"(*", 
            RowBox[{"INITIAL", " ", "SETUPS"}], "*)"}], "Section"], 
          StyleBox["\[IndentingNewLine]", "Section"], " ", 
          RowBox[{"(*", 
           RowBox[{
           "max", " ", "number", " ", "of", " ", "layers", " ", "in", " ", 
            "the", " ", "system"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"maxmaterialnumber", "=", "10"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "reset", " ", "materials", " ", "to", " ", "air", " ", "if", " ", 
            "not", " ", "used", " ", "in", " ", "materialnumber"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"allmaterials", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"materialnumber", "+", "2"}], ";;", 
              "maxmaterialnumber"}], "]"}], "]"}], "=", 
           RowBox[{"Table", "[", 
            RowBox[{"mbot", ",", 
             RowBox[{"maxmaterialnumber", "-", "materialnumber", "-", "1"}]}],
             "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "create", " ", "dgrid", " ", "for", " ", "display", " ", "and", 
            " ", "input"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"clearFigs", "[", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"dgrid", "=", 
           RowBox[{"Dynamic", "[", 
            RowBox[{"Grid", "[", 
             RowBox[{
              RowBox[{"generatingdfun1", "[", "matindex", "]"}], ",", 
              RowBox[{"Spacings", "->", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"ItemSize", "->", "All"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "assign", " ", "values", " ", "to", " ", "dependnet", " ", "d", 
            " ", "components"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"indexfun1", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"materialnumber", "+", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"zvecplots2d", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"placeHolderFigs", ",", "maxmaterialnumber"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"zvecplots3d", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"placeHolderFigs", ",", "maxmaterialnumber"}], "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Functionality", "\[NotEqual]", "\"\<User Guide\>\""}], 
            ",", 
            RowBox[{"progress", "=", "10"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"(*", 
            RowBox[{"INITIALIZE", " ", "PRESETS"}], "*)"}], "Section"], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Functionality", "\[NotEqual]", "\"\<User Guide\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ValueQ", "[", "startupvar", "]"}], ",", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "ptest1", ",", "ptest2", ",", "ptest3", ",", "ptest4", ",", 
                  "ptest5", ",", "ptest6", ",", "ptest7", ",", "ptest8"}], 
                 "}"}], "=", 
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", "8"}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ValueQ", "[", "startupvar", "]"}], ",", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "plabel1", ",", "plabel2", ",", "plabel3", ",", "plabel4", 
                  ",", "plabel5", ",", "plabel6", ",", "plabel7", ",", 
                  "plabel8"}], "}"}], "=", 
                RowBox[{"Table", "[", 
                 RowBox[{"\"\<Type Label Here\>\"", ",", "8"}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"startupvar", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "ap1", ",", "ap2", ",", "ap3", ",", "ap4", ",", "ap5", ",", 
                "ap6", ",", "ap7", ",", "ap8"}], "}"}], "=", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"ptest1", "==", "0"}], "]"}], ",", 
                  RowBox[{"{", "\"\<DialogBox\>\"", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<DialogBox\>\"", ",", "\"\<Pressed\>\""}], 
                   "}"}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"ptest2", "==", "0"}], "]"}], ",", 
                  RowBox[{"{", "\"\<DialogBox\>\"", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<DialogBox\>\"", ",", "\"\<Pressed\>\""}], 
                   "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"ptest3", "==", "0"}], "]"}], ",", 
                  RowBox[{"{", "\"\<DialogBox\>\"", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<DialogBox\>\"", ",", "\"\<Pressed\>\""}], 
                   "}"}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"ptest4", "==", "0"}], "]"}], ",", 
                  RowBox[{"{", "\"\<DialogBox\>\"", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<DialogBox\>\"", ",", "\"\<Pressed\>\""}], 
                   "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"ptest5", "==", "0"}], "]"}], ",", 
                  RowBox[{"{", "\"\<DialogBox\>\"", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<DialogBox\>\"", ",", "\"\<Pressed\>\""}], 
                   "}"}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"ptest6", "==", "0"}], "]"}], ",", 
                  RowBox[{"{", "\"\<DialogBox\>\"", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<DialogBox\>\"", ",", "\"\<Pressed\>\""}], 
                   "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"ptest7", "==", "0"}], "]"}], ",", 
                  RowBox[{"{", "\"\<DialogBox\>\"", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<DialogBox\>\"", ",", "\"\<Pressed\>\""}], 
                   "}"}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"ptest8", "==", "0"}], "]"}], ",", 
                  RowBox[{"{", "\"\<DialogBox\>\"", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<DialogBox\>\"", ",", "\"\<Pressed\>\""}], 
                   "}"}]}], "]"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "All", " ", "setup", " ", "depending", " ", "on", " ", "anything", 
            " ", "in", " ", "the", " ", "TrackedSymbols", " ", "go", " ", 
            "here"}], "*)"}], "\[IndentingNewLine]", 
          StyleBox["\[IndentingNewLine]", "Subsubsection"], 
          StyleBox[
           RowBox[{"(*", 
            RowBox[{"hkl", " ", "CONVERSION"}], "*)"}], "Section"], 
          StyleBox["\[IndentingNewLine]", "Subsubsection"], 
          RowBox[{"(*", 
           RowBox[{"convert", " ", "between", " ", 
            RowBox[{"orientation", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "and", " ", 
            RowBox[{"orientation", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Functionality", "\[NotEqual]", "\"\<User Guide\>\""}], 
            ",", 
            RowBox[{"ruihklfun", "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"materialnumber", "+", "2"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Functionality", "\[NotEqual]", "\"\<User Guide\>\""}], 
            ",", 
            RowBox[{"progress", "=", "15"}]}], "]"}], ";", 
          StyleBox["\[IndentingNewLine]", "Section"], "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"(*", 
            StyleBox["CALCULATIONS",
             FontWeight->"Bold"], 
            StyleBox[" ",
             FontWeight->"Bold"], "*)"}], "Chapter"], "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"(*", 
            RowBox[{"single", " ", "run"}], "*)"}], "Section"], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}], 
             "\[Or]", 
             RowBox[{
             "Functionality", "==", 
              "\"\<Partial Analytical Expressions\>\""}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\[Omega]0", "=", 
              RowBox[{"N", "@", 
               RowBox[{"(", 
                RowBox[{"2", " ", "Pi", " ", 
                 RowBox[{"c0", "/", "\[Lambda]"}]}], ")"}]}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "@", "theta"}], ">=", "89"}], ",", 
               RowBox[{"theta", "=", 
                RowBox[{
                 RowBox[{"Sign", "[", "theta", "]"}], "89.0"}]}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"wInc", "=", 
              RowBox[{"setwInc", "[", 
               RowBox[{"\[Omega]0", ",", 
                RowBox[{"N", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"theta", "/", "180"}], " ", "Pi"}], ")"}]}], ",", 
                "\[CapitalDelta]\[Delta]", ",", "\[CurlyPhi]", ",", "n0"}], 
               "]"}]}], ";", 
             RowBox[{"extWave", "@", "wInc"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "setup", " ", "all", " ", "materials", " ", "into", " ", 
                "mats"}], "=", 
               RowBox[{"{", 
                RowBox[{"m1", ",", "m2", ",", "m3", ",", "..."}], "}"}]}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ToExpression", "[", 
                RowBox[{
                 RowBox[{"\"\<m\>\"", "<>", 
                  RowBox[{"ToString", "[", "#", "]"}]}], ",", "InputForm", 
                 ",", 
                 RowBox[{"Function", "[", 
                  RowBox[{"name", ",", 
                   RowBox[{"name", "=", 
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ",", "HoldAll"}], 
                  "]"}]}], "]"}], "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"materialnumber", "+", "2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ToExpression", "[", 
                RowBox[{
                 RowBox[{"\"\<m\>\"", "<>", 
                  RowBox[{"ToString", "[", "#", "]"}]}], ",", "InputForm", 
                 ",", 
                 RowBox[{"Function", "[", 
                  RowBox[{"name", ",", 
                   RowBox[{"extMater", "@", "name"}], ",", "HoldAll"}], 
                  "]"}]}], "]"}], "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"materialnumber", "+", "2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "always", " ", "set", " ", "1", "st", " ", "material", " ", 
               "to", " ", "be", " ", "air"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"m1", "=", 
              RowBox[{"setMater", "@", 
               RowBox[{"Air", "[", "]"}]}]}], ";", 
             RowBox[{"extMater", "@", "m1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"mats", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"ToExpression", "[", 
                 RowBox[{
                  RowBox[{"\"\<m\>\"", "<>", 
                   RowBox[{"ToString", "[", "#", "]"}]}], ",", "InputForm", 
                  ",", 
                  RowBox[{"Function", "[", 
                   RowBox[{"name", ",", "name", ",", "HoldAll"}], "]"}]}], 
                 "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"materialnumber", "+", "2"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "detect", " ", "if", " ", "analytical", " ", "d", " ", "or", 
               " ", "h", " ", "is", " ", "used"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"noAnalytical", "=", 
              RowBox[{"And", "@@", 
               RowBox[{"NumberQ", "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Key", "[", "dC", "]"}], "/@", "mats"}], ")"}]}], 
                   ")"}], "~", "Join", "~", 
                  RowBox[{"(", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Key", "[", "h", "]"}], "/@", "mats"}], ")"}]}], 
                   ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"mrassumption", "==", "0"}], ",", 
               RowBox[{"(*", "FMR", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"winhAssumption", "==", "0"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"flagBackward", "=", "False"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"flagStandingWave", "=", "False"}], ";"}], 
                  "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                  RowBox[{"winhAssumption", "==", "1"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"flagBackward", "=", "True"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"flagStandingWave", "=", "False"}], ";"}], 
                  "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                  RowBox[{"winhAssumption", "==", "2"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"flagBackward", "=", "True"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"flagStandingWave", "=", "True"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"flagJK", "=", "False"}], ";", 
                RowBox[{"flagHH", "=", "False"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"wavL", ",", "wavNL"}], "}"}], "=", 
                 RowBox[{"f4NL", "[", 
                  RowBox[{"mats", ",", "wInc"}], "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"mrassumption", "==", "1"}], ",", 
                 RowBox[{"(*", "JK", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"flagBackward", "=", "False"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"flagStandingWave", "=", "False"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"flagJK", "=", "True"}], ";", 
                  RowBox[{"flagHH", "=", "False"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"wavL", ",", "wavNL"}], "}"}], "=", 
                   RowBox[{"f4NL", "[", 
                    RowBox[{"mats", ",", "wInc", ",", "True"}], "]"}]}], 
                  ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"mrassumption", "==", "2"}], ",", 
                   RowBox[{"(*", "HH", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"flagBackward", "=", "False"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"flagStandingWave", "=", "False"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"flagJK", "=", "False"}], ";", 
                    RowBox[{"flagHH", "=", "True"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"wavL", ",", "wavNL"}], "}"}], "=", 
                    RowBox[{"f4NL", "[", 
                    RowBox[{"mats", ",", "wInc", ",", "True"}], "]"}]}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}]}], 
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"evaltime", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"StartTime", "=", 
           RowBox[{"SessionTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Functionality", "\[NotEqual]", "\"\<User Guide\>\""}], 
            ",", 
            RowBox[{"progress", "=", "25"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"(*", 
            RowBox[{
            "batch", " ", "run", " ", "for", " ", "Fresnel", " ", "and", " ", 
             "Maker", " ", "fringes"}], "*)"}], "Section"], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FresnelList", "=", 
              RowBox[{"{", "}"}]}], ";", 
             RowBox[{"MFList", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"fresnelcontrol", 
                RowBox[{"(*", 
                 RowBox[{"&&", 
                  RowBox[{"(", 
                   RowBox[{"!", "makerfringescontrol"}], ")"}]}], "*)"}], "&&",
                 "noAnalytical"}], ",", "\[IndentingNewLine]", 
               RowBox[{"FresnelList", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Fresnel", "[", 
                   RowBox[{"mats", ",", "#", ",", "mrassumption"}], "]"}], 
                  "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"0.0", ",", "89.0", ",", "thetastep1"}], 
                  "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"makerfringescontrol", 
                RowBox[{"(*", 
                 RowBox[{"&&", 
                  RowBox[{"(", 
                   RowBox[{"!", "fresnelcontrol"}], ")"}]}], "*)"}], "&&", 
                "noAnalytical"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "@", "maxtheta2"}], ">=", "89"}], ",", 
                  RowBox[{"maxtheta2", "=", 
                   RowBox[{
                    RowBox[{"Sign", "[", "maxtheta2", "]"}], "89.0"}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"MFList", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MF", "[", 
                    RowBox[{"mats", ",", "#", ",", "mrassumption"}], "]"}], 
                   "&"}], "/@", 
                  RowBox[{"Range", "[", 
                   RowBox[{"mintheta2", ",", "maxtheta2", ",", "thetastep2"}],
                    "]"}]}]}]}], ","}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"!", "noAnalytical"}], ")"}], ",", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<Only numerical simulation is supported for Maker \
fringes calcaulation;  Either analytical d or h is given! Abort!\>\"", " ", 
                 "]"}], ";", 
                RowBox[{"Abort", "[", "]"}], ";"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"(*", 
            RowBox[{"Postprocessing", " ", "for", " ", "plots"}], "*)"}], 
           "Chapter"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"(*", 
            RowBox[{"For", " ", "Set", " ", "Material", " ", "Properties"}], 
            "*)"}], "Section"], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "Functionality", "==", "\"\<Set Material Properties\>\""}], " ", 
             "||", " ", 
             RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}], " ", "||",
              " ", 
             RowBox[{
             "Functionality", "==", 
              "\"\<Partial Analytical Expressions\>\""}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            StyleBox[
             RowBox[{"(*", 
              RowBox[{"PLOTTING", " ", "SCHEMATIC", " ", "FIGURES"}], "*)"}], 
             "Subsubsection"], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"heterostructureschematic", "=", 
              RowBox[{"Show", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Graphics", "[", 
                 RowBox[{"{", 
                  RowBox[{"White", ",", 
                   RowBox[{"EdgeForm", "[", 
                    RowBox[{"Directive", "[", "White", "]"}], "]"}], ",", 
                   RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.5"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", 
                    RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\>\"", ",", "15", ",", "Black", ",", "Bold"}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1.75"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Air\>\"", ",", "15", ",", "Black", ",", "Bold"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"8.5", ",", 
                    RowBox[{"-", "1.75"}]}], "}"}]}], "]"}]}], "}"}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics", "[", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"DownArrow", "[", 
                    RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "]"}], "]"}], 
                    "<>", "\"\<Incident Light, \>\"", "<>", 
                    RowBox[{"ToString", "[", "\[Lambda]", "]"}], "<>", 
                    "\"\<\[Mu]m\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"DownArrow", "[", 
                    RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "]"}], "]"}]}], 
                    ",", "20", ",", "Blue", ",", "Bold"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"5", ",", 
                    RowBox[{"-", "1.75"}]}], "}"}]}], "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"schematicfun", "/@", 
                 RowBox[{"(", 
                  RowBox[{"Reverse", "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"materialnumber", "+", "2"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"materialnumber", "+", "1"}]}], "]"}]}], ")"}]}], 
                  ")"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Graphics", "[", 
                 RowBox[{"{", 
                  RowBox[{"White", ",", 
                   RowBox[{"EdgeForm", "[", 
                    RowBox[{"Directive", "[", "White", "]"}], "]"}], ",", 
                   RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"-", "materialnumber"}], "-", "2", "-", "0.1"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"10", ",", 
                    RowBox[{
                    RowBox[{"-", "materialnumber"}], "-", "3"}]}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<\>\"", 
                    RowBox[{"(*", 
                    RowBox[{"ToString", "[", "materialnumber", "]"}], "*)"}], 
                    ",", "15", ",", "Black", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{"-", "materialnumber"}], "-", "2", "-", 
                    "0.25"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Air\>\"", ",", "15", ",", "Black", ",", "Bold"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"8.5", ",", 
                    RowBox[{
                    RowBox[{"-", "materialnumber"}], "-", "2", "-", 
                    "0.25"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
                  "}"}], "]"}], "\[IndentingNewLine]", ",", 
                RowBox[{"ImageSize", "->", 
                 RowBox[{"{", 
                  RowBox[{"600", ",", "Automatic"}], "}"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"zvecplots2d", "=", 
              RowBox[{"fzvecplots2d", "/@", "allmaterials"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"zvecplots3d", "=", 
              RowBox[{"fzvecplots3d", "/@", "allmaterials"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"(*", 
            RowBox[{"For", " ", "SHG", " ", "Simulation"}], "*)"}], "Section"],
           "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
             "noAnalytical", ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              StyleBox[
               RowBox[{"(*", 
                RowBox[{"PLOTTING", " ", "WAVE", " ", "PATH"}], "*)"}], 
               "Subsubsection"], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fig13d", "=", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{"incident", " ", "\[Omega]", " ", "wave"}], 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{"wInc", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], "-", 
                    RowBox[{"Normalize", "[", 
                    RowBox[{"wInc", "[", "k", "]"}], "]"}]}], ",", "Red"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"\[Omega]", " ", "waves", " ", "in", " ", "red"}],
                     "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"transmission", " ", "waves"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "materialnumber"}], 
                    "}"}], ",", "Red"}], "]"}], "&"}], "/@", 
                    RowBox[{"wavL", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"reflection", " ", "waves"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    "Red"}], "]"}], "&"}], "/@", 
                    RowBox[{"wavL", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"forward", " ", "waves"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Red"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Red"}], "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"wavL", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ")"}], ",", 
                    "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"backward", " ", "waves"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", 
                    RowBox[{"Sequence", "@@", "#2"}]}], "}"}], ",", "Red"}], 
                    "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", 
                    RowBox[{"Sequence", "@@", "#2"}]}], "}"}], ",", "Red"}], 
                    "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"wavL", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ")"}], ",", 
                    "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "2", "\[Omega]", " ", "homo", " ", "waves", " ", "in", 
                    " ", "blue"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"transmission", " ", "waves"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "materialnumber"}], "}"}], 
                    ",", "Blue"}], "]"}], "&"}], "/@", 
                    RowBox[{"wavNL", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"reflection", " ", "waves"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "Blue"}], 
                    "]"}], "&"}], "/@", 
                    RowBox[{"wavNL", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"forward", " ", "waves"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Blue"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Blue"}], "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"wavNL", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ")"}], ",", 
                    "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"backward", " ", "waves"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"Sequence", "@@", "#2"}]}], "}"}], ",", "Blue"}], 
                    "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"Sequence", "@@", "#2"}]}], "}"}], ",", "Blue"}], 
                    "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"wavNL", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ")"}], ",", 
                    "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "2", "\[Omega]", " ", "inhomo", " ", "waves", " ", "in", 
                    " ", "orange"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"mrassumption", "==", "0"}], ",", " ", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"flagBackward", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"flagStandingWave", ",", "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"Sequence", "@@", "#2"}]}], "}"}], ",", 
                    "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"Sequence", "@@", "#2"}]}], "}"}], ",", 
                    "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"Sequence", "@@", "#2"}]}], "}"}], ",", 
                    "Orange"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "7", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", ".5"}], ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", ".5"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "8", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", ".5"}], ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", ".5"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "9", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", ".5"}], ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", ".5"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "10", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0", "-", ".5"}], ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", ".5"}]}], "}"}], 
                    ",", "Orange"}], "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"wavNL", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ")"}], ",", 
                    "1"}], "]"}]}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"Sequence", "@@", "#2"}]}], "}"}], ",", 
                    "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"Sequence", "@@", "#2"}]}], "}"}], ",", 
                    "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"Sequence", "@@", "#2"}]}], "}"}], ",", 
                    "Orange"}], "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"wavNL", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ")"}], ",", 
                    "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"wavNL", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ")"}], ",", 
                    "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}], ",", 
                    RowBox[{"pltWav", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#2"}], "-", "1"}]}], "}"}], 
                    ",", "Orange"}], "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"wavNL", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ")"}], ",", 
                    "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", "interfaces", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Hyperplane", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], 
                    "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "materialnumber"}], "]"}]}], ")"}]}]}], 
                   "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Evaluate", "@", "options2d"}], ",", 
                  RowBox[{"PlotLabel", "->", 
                   RowBox[{"\"\<\[Lambda] of \[Omega] wave (\[Mu]m) = \>\"", "<>", 
                    RowBox[{"ToString", "[", "\[Lambda]", "]"}]}]}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"fig12d", "=", 
                RowBox[{"Show", "[", 
                 RowBox[{"fig13d", ",", 
                  RowBox[{"ViewPoint", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "Infinity", ",", "0"}], "}"}]}], ",", 
                  RowBox[{"Method", "->", 
                   RowBox[{"{", 
                    RowBox[{"\"\<RotationControl\>\"", "->", "None"}], 
                    "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               StyleBox[
                RowBox[{"(*", 
                 RowBox[{
                 "PLOTTING", " ", "ELLIPSOMETRY", " ", "of", " ", "2", 
                  "\[Omega]", " ", "waves"}], "*)"}], "Subsubsection"], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "for", " ", "the", " ", "polarplot", " ", "of", " ", 
                 "reflected", " ", "waves"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"rmpw1", ",", "rmpw2"}], "}"}], "=", 
                RowBox[{"wavNL", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                  RowBox[{"[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", "is", " ", "for", " ",
                   "reflected"}], ",", " ", 
                 RowBox[{
                  RowBox[{"[", 
                   RowBox[{"[", "2", "]"}], "]"}], " ", "is", " ", "for", " ",
                   "transmitted"}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"extWave", "@", "rmpw1"}], ";", 
               RowBox[{"extWave", "@", "rmpw2"}], ";", "\[IndentingNewLine]", 
               RowBox[{"rSignal", "=", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Psi]", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "\[Psi]", "]"}], ",", 
                    RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "}"}]}], "}"}], 
                 ".", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"rmpw1", "[", "A", "]"}], "+", 
                    RowBox[{"rmpw2", "[", "A", "]"}]}], ")"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "for", " ", "the", " ", "polarplot", " ", "of", " ", 
                 "transmitive", " ", "waves"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"tmpw1", ",", "tmpw2"}], "}"}], "=", 
                RowBox[{"wavNL", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                  RowBox[{"[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", "is", " ", "for", " ",
                   "reflected"}], ",", " ", 
                 RowBox[{
                  RowBox[{"[", 
                   RowBox[{"[", "2", "]"}], "]"}], " ", "is", " ", "for", " ",
                   "transmitted"}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"extWave", "@", "tmpw1"}], ";", 
               RowBox[{"extWave", "@", "tmpw2"}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"tSignal", "=", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Psi]", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "\[Psi]", "]"}], ",", 
                    RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "}"}]}], "}"}], 
                   ".", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"tmpw1", "[", "A", "]"}], "+", 
                    RowBox[{"tmpw2", "[", "A", "]"}]}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}]}], ";"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"tSignal", "=", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Psi]", "]"}], ",", 
                    RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "}"}]}], "}"}], 
                 ".", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"tmpw1", "[", "A", "]"}], "+", 
                    RowBox[{"tmpw2", "[", "A", "]"}]}], ")"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"rules", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[CapitalDelta]\[Delta]", "\[Rule]", 
                   RowBox[{"delta", " ", "Degree"}]}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{"RotatePolarizer", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"\[CurlyPhi]", "->", 
                    RowBox[{"phi", " ", "Degree"}]}]}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{"RotateAnalyzer", ",", 
                    RowBox[{"\[Psi]", "->", 
                    RowBox[{"\[CurlyPhi]", "+", 
                    RowBox[{"analyzeroffset", " ", "Degree"}]}]}], ",", 
                    RowBox[{"\[Psi]", "->", 
                    RowBox[{"psi", " ", "Degree"}]}]}], "]"}]}], "}"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"dataRs", "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"rSignal", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"rSignal", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "/.", 
                 "rules"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"dataRp", "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"rSignal", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"rSignal", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}], "/.", 
                 "rules"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"dataTs", "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"tSignal", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"tSignal", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "/.", 
                 "rules"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"dataTp", "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"tSignal", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                   RowBox[{"Conjugate", "[", 
                    RowBox[{"tSignal", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}], "/.", 
                 "rules"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "factorRp", ",", "factorRs", ",", "factorTp", ",", 
                  "factorTs"}], "}"}], "=", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], ";", 
               RowBox[{"Imax", "=", "1"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Quiet", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"MaxRp", ",", "MaxRs", ",", "MaxTp", ",", "MaxTs"}],
                   "}"}], "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"NMaxValue", "[", 
                    RowBox[{
                    RowBox[{"Re", "@", "dataRp"}], ",", "\[CurlyPhi]"}], 
                    "]"}], ",", 
                   RowBox[{"NMaxValue", "[", 
                    RowBox[{
                    RowBox[{"Re", "@", "dataRs"}], ",", "\[CurlyPhi]"}], 
                    "]"}], ",", 
                   RowBox[{"NMaxValue", "[", 
                    RowBox[{
                    RowBox[{"Re", "@", "dataTp"}], ",", "\[CurlyPhi]"}], 
                    "]"}], ",", 
                   RowBox[{"NMaxValue", "[", 
                    RowBox[{
                    RowBox[{"Re", "@", "dataTs"}], ",", "\[CurlyPhi]"}], 
                    "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Imax", "=", 
                RowBox[{"1.1", 
                 RowBox[{"Max", "[", 
                  RowBox[{"MaxRp", ",", "MaxRs", ",", "MaxTp", ",", "MaxTs"}],
                   "]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "@", "Imax"}], "<", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "10"}]]}], ",", 
                 RowBox[{"Imax", "=", "1"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"factorRp", "=", 
                RowBox[{"Max", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", "MaxRp", "]"}], "!=", "0"}], ",", 
                    RowBox[{"IntegerPart", "[", 
                    RowBox[{"Imax", "/", "MaxRp"}], "]"}], ",", "0"}], 
                   "]"}]}], "]"}]}], ";", 
               RowBox[{"factorRs", "=", 
                RowBox[{"Max", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", "MaxRs", "]"}], "!=", "0"}], ",", 
                    RowBox[{"IntegerPart", "[", 
                    RowBox[{"Imax", "/", "MaxRs"}], "]"}], ",", "0"}], 
                   "]"}]}], "]"}]}], ";", 
               RowBox[{"factorTp", "=", 
                RowBox[{"Max", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", "MaxTp", "]"}], "!=", "0"}], ",", 
                    RowBox[{"IntegerPart", "[", 
                    RowBox[{"Imax", "/", "MaxTp"}], "]"}], ",", "0"}], 
                   "]"}]}], "]"}]}], ";", 
               RowBox[{"factorTs", "=", 
                RowBox[{"Max", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", "MaxTs", "]"}], "!=", "0"}], ",", 
                    RowBox[{"IntegerPart", "[", 
                    RowBox[{"Imax", "/", "MaxTs"}], "]"}], ",", "0"}], 
                   "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"polarRp", "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/", "Imax"}], ")"}], "*", "factorRp", "*", 
                 RowBox[{"Re", "@", "dataRp"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"polarRs", "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/", "Imax"}], ")"}], "*", "factorRs", "*", 
                 RowBox[{"Re", "@", "dataRs"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"polarTp", "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/", "Imax"}], ")"}], "*", "factorTp", "*", 
                 RowBox[{"Re", "@", "dataTp"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"polarTs", "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/", "Imax"}], ")"}], "*", "factorTs", "*", 
                 RowBox[{"Re", "@", "dataTs"}]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"!", "RotateAnalyzer"}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{"!", "RotatePolarizer"}], ")"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"figRp", "=", 
                   RowBox[{"PolarPlot", "[", 
                    RowBox[{"polarRp", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CurlyPhi]", ",", 
                    RowBox[{"phi", " ", "Degree"}], ",", 
                    RowBox[{
                    RowBox[{"phi", " ", "Degree"}], "+", "0.01"}]}], "}"}], 
                    ",", 
                    RowBox[{"Evaluate", "@", "options2"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.05", "]"}]}], "}"}]}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Reflected SHG (a.u.) \[Times] \>\"", "<>", 
                    RowBox[{"ToString", "[", "factorRp", "]"}]}], ",", "22", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"PlotLabel", "->", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(R, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi])\>\"", ",", "28", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"figRs", "=", 
                   RowBox[{"PolarPlot", "[", 
                    RowBox[{"polarRs", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CurlyPhi]", ",", 
                    RowBox[{"phi", " ", "Degree"}], ",", 
                    RowBox[{
                    RowBox[{"phi", " ", "Degree"}], "+", "0.01"}]}], "}"}], 
                    ",", 
                    RowBox[{"Evaluate", "@", "options2"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Thickness", "[", "0.05", "]"}]}], "}"}]}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Reflected SHG (a.u.) \[Times] \>\"", "<>", 
                    RowBox[{"ToString", "[", "factorRs", "]"}]}], ",", "22", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"PlotLabel", "->", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(R, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi]+\!\(\*FractionBox[\(\[Pi]\), \(2\)]\))\>\"", ",", "28", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"figTp", "=", 
                   RowBox[{"PolarPlot", "[", 
                    RowBox[{"polarTp", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CurlyPhi]", ",", 
                    RowBox[{"phi", " ", "Degree"}], ",", 
                    RowBox[{
                    RowBox[{"phi", " ", "Degree"}], "+", "0.01"}]}], "}"}], 
                    ",", 
                    RowBox[{"Evaluate", "@", "options2"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.05", "]"}]}], "}"}]}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Transmitted SHG (a.u.) \[Times] \>\"", "<>", 
                    RowBox[{"ToString", "[", "factorTp", "]"}]}], ",", "22", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"PlotLabel", "->", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(T, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi])\>\"", ",", "28", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"figTs", "=", 
                   RowBox[{"PolarPlot", "[", 
                    RowBox[{"polarTs", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CurlyPhi]", ",", 
                    RowBox[{"phi", " ", "Degree"}], ",", 
                    RowBox[{
                    RowBox[{"phi", " ", "Degree"}], "+", "0.01"}]}], "}"}], 
                    ",", 
                    RowBox[{"Evaluate", "@", "options2"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Thickness", "[", "0.05", "]"}]}], "}"}]}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Transmitted SHG (a.u.) \[Times] \>\"", "<>", 
                    RowBox[{"ToString", "[", "factorTs", "]"}]}], ",", "22", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"PlotLabel", "->", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(T, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi]+\!\(\*FractionBox[\(\[Pi]\), \(2\)]\))\>\"", ",", "28", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"figRp", "=", 
                   RowBox[{"PolarPlot", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "Imax"}], ")"}], "*", "factorRp", "*", 
                    RowBox[{"Re", "@", "dataRp"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CurlyPhi]", ",", "0", ",", 
                    RowBox[{"2", "Pi"}]}], "}"}], ",", 
                    RowBox[{"Evaluate", "@", "options2"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.01", "]"}]}], "}"}]}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Reflected SHG (a.u.) \[Times] \>\"", "<>", 
                    RowBox[{"ToString", "[", "factorRp", "]"}]}], ",", "22", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"PlotLabel", "->", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(R, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi])\>\"", ",", "28", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"figRs", "=", 
                   RowBox[{"PolarPlot", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "Imax"}], ")"}], "*", "factorRs", "*", 
                    RowBox[{"Re", "@", "dataRs"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CurlyPhi]", ",", "0", ",", 
                    RowBox[{"2", "Pi"}]}], "}"}], ",", 
                    RowBox[{"Evaluate", "@", "options2"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Thickness", "[", "0.01", "]"}]}], "}"}]}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Reflected SHG (a.u.) \[Times] \>\"", "<>", 
                    RowBox[{"ToString", "[", "factorRs", "]"}]}], ",", "22", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"PlotLabel", "->", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(R, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi]+\!\(\*FractionBox[\(\[Pi]\), \(2\)]\))\>\"", ",", "28", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"figTp", "=", 
                   RowBox[{"PolarPlot", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "Imax"}], ")"}], "*", "factorTp", "*", 
                    RowBox[{"Re", "@", "dataTp"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CurlyPhi]", ",", "0", ",", 
                    RowBox[{"2", "Pi"}]}], "}"}], ",", 
                    RowBox[{"Evaluate", "@", "options2"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.01", "]"}]}], "}"}]}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Transmitted SHG (a.u.) \[Times] \>\"", "<>", 
                    RowBox[{"ToString", "[", "factorTp", "]"}]}], ",", "22", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"PlotLabel", "->", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(T, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi])\>\"", ",", "28", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"figTs", "=", 
                   RowBox[{"PolarPlot", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "Imax"}], ")"}], "*", "factorTs", "*", 
                    RowBox[{"Re", "@", "dataTs"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CurlyPhi]", ",", "0", ",", 
                    RowBox[{"2", "Pi"}]}], "}"}], ",", 
                    RowBox[{"Evaluate", "@", "options2"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Thickness", "[", "0.01", "]"}]}], "}"}]}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Transmitted SHG (a.u.) \[Times] \>\"", "<>", 
                    RowBox[{"ToString", "[", "factorTs", "]"}]}], ",", "22", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], ",", "None"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"PlotLabel", "->", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(T, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi]+\!\(\*FractionBox[\(\[Pi]\), \(2\)]\))\>\"", ",", "28", 
                    ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}]}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
                ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               StyleBox[
                RowBox[{"(*", 
                 RowBox[{
                 "Plot", " ", "maker", " ", "fringes", " ", "and", " ", 
                  "fresnel", " ", "figures"}], "*)"}], "Subsubsection"], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"makerfringescontrol", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"listMFpara", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"MFList", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}], "/.", 
                    RowBox[{"\[CapitalDelta]\[Delta]", "->", 
                    RowBox[{"delta", " ", "Degree"}]}]}], "/.", 
                    RowBox[{"\[CurlyPhi]", "->", 
                    RowBox[{"phi", " ", "Degree"}]}]}], " ", "/.", 
                    RowBox[{"\[Psi]", "->", 
                    RowBox[{"psi", " ", "Degree"}]}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"figmakerfringespar", "=", "\[IndentingNewLine]", 
                   RowBox[{"ListLinePlot", "[", 
                    RowBox[{"listMFpara", ",", 
                    RowBox[{"PlotRange", "->", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Thickness", "[", "0.01", "]"}], "]"}]}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"FrameStyle", "->", 
                    RowBox[{"Directive", "@", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", "18", ",", "Thick"}], "}"}]}]}], 
                    ",", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "Style", "[", 
                    "\"\<Incident Angle, \!\(\*SuperscriptBox[\(\[Theta]\), \
\(i\)]\)\>\"", "]"}], ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(2  \[Omega], T\)]\)(\!\
\(\*SuperscriptBox[\(\[Theta]\), \(i\)]\),\[CurlyPhi],\[Psi]) (a.u.)\>\"", 
                    "]"}], ",", 
                    RowBox[{"BaseStyle", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FontSize", "->", "18"}], ",", 
                    RowBox[{"FontFamily", "->", "\"\<Times New Roman\>\""}]}],
                     "}"}]}]}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "->", "Large"}]}], 
                    RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{"FrameTicksStyle", "->", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"FontOpacity", "->", "0"}], ",", 
                    RowBox[{"FontSize", "->", "0"}]}], "]"}]}], "}"}]}]}], 
                    "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"listMFperp", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"MFList", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}], "/.", 
                    RowBox[{"\[CapitalDelta]\[Delta]", "->", 
                    RowBox[{"delta", " ", "Degree"}]}]}], "/.", 
                    RowBox[{"\[CurlyPhi]", "->", 
                    RowBox[{"phi", " ", "Degree"}]}]}], "/.", 
                    RowBox[{"\[Psi]", "->", 
                    RowBox[{
                    RowBox[{"(", "psi", ")"}], " ", "Degree"}]}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"figmakerfringesperp", "=", "\[IndentingNewLine]", 
                   RowBox[{"ListLinePlot", "[", 
                    RowBox[{"listMFperp", ",", 
                    RowBox[{"PlotRange", "->", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Thickness", "[", "0.01", "]"}], "]"}]}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"FrameStyle", "->", 
                    RowBox[{"Directive", "@", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", "18", ",", "Thick"}], "}"}]}]}], 
                    ",", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "Style", "[", 
                    "\"\<Incident Angle, \!\(\*SuperscriptBox[\(\[Theta]\), \
\(i\)]\)\>\"", "]"}], ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(2  \[Omega], T\)]\)(\!\
\(\*SuperscriptBox[\(\[Theta]\), \(i\)]\),\[CurlyPhi],\[Psi]+90\[Degree]) \
(a.u.)\>\"", "]"}], ",", 
                    RowBox[{"BaseStyle", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FontSize", "->", "18"}], ",", 
                    RowBox[{"FontFamily", "->", "\"\<Times New Roman\>\""}]}],
                     "}"}]}]}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"fresnelcontrol", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"listFresnel", "=", 
                   RowBox[{"Evaluate", "[", 
                    RowBox[{"Re", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"FresnelList", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "/.", 
                    RowBox[{"\[CurlyPhi]", "->", 
                    RowBox[{"0", " ", "Degree"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"FresnelList", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], "/.", 
                    RowBox[{"\[CurlyPhi]", "->", 
                    RowBox[{"90", " ", "Degree"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"FresnelList", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], "/.", 
                    RowBox[{"\[CurlyPhi]", "->", 
                    RowBox[{"0", " ", "Degree"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"FresnelList", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], "/.", 
                    RowBox[{"\[CurlyPhi]", "->", 
                    RowBox[{"90", " ", "Degree"}]}]}]}], "}"}], "/.", 
                    RowBox[{"\[CapitalDelta]\[Delta]", "->", "0"}]}], ")"}]}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"figfresnel", "=", "\[IndentingNewLine]", 
                   RowBox[{"ListLinePlot", "[", 
                    RowBox[{"listFresnel", ",", 
                    RowBox[{"PlotRange", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "90"}], "}"}], ",", "Automatic"}], 
                    "}"}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Thickness", "[", "0.01", "]"}], "]"}]}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"FrameStyle", "->", 
                    RowBox[{"Directive", "@", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", "18", ",", "Thick"}], "}"}]}]}], 
                    ",", 
                    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<Incident Angle, \!\(\*SuperscriptBox[\(\[Theta]\), \
\(i\)]\)\>\"", "]"}], 
                    RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{
                    "Style", "[", "\"\<Fresnel Transmittance/Reflectance\>\"",
                     "]"}]}], "*)"}], "}"}]}], ",", 
                    RowBox[{"PlotLabel", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Fresnel Transmittance/Reflectance\>\"", ",", "Black",
                     ",", "20"}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "->", 
                    RowBox[{"{", 
                    RowBox[{"400", ",", "400"}], "}"}]}], ",", 
                    RowBox[{"PlotLegends", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(R\), \(p\)]\)\>\"", ",", "20"}],
                     "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(R\), \(s\)]\)\>\"", ",", "20"}],
                     "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(T\), \(p\)]\)\>\"", ",", "20"}],
                     "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(T\), \(s\)]\)\>\"", ",", "20"}],
                     "]"}]}], "}"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
                "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               StyleBox[
                RowBox[{"(*", 
                 RowBox[{
                 "Plot", " ", "schematics", " ", "for", " ", "optical", " ", 
                  "geometry"}], "*)"}], "Subsubsection"], 
               "\[IndentingNewLine]", 
               RowBox[{"plot2geometry2d", "=", 
                RowBox[{"fplot2geometry2d", "[", "theta", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"plot2geometry3d", "=", 
                RowBox[{"fplot2geometry3d", "[", "theta", "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               StyleBox[
                RowBox[{"(*", 
                 RowBox[{
                 "Plot", " ", "schematics", " ", "for", " ", "optical", " ", 
                  "polarization"}], "*)"}], "Subsubsection"], 
               "\[IndentingNewLine]", 
               RowBox[{"polarizationplot2d", "=", 
                RowBox[{"fpolarizationplot2d", "[", 
                 RowBox[{
                 "theta", ",", "phi", ",", "psi", ",", "RotatePolarizer", ",",
                   "RotateAnalyzer"}], "]"}]}], ";", 
               RowBox[{"polarizationplot3d", "=", 
                RowBox[{"fpolarizationplot3d", "[", 
                 RowBox[{
                 "theta", ",", "phi", ",", "psi", ",", "RotatePolarizer", ",",
                   "RotateAnalyzer"}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               StyleBox[
                RowBox[{"(*", 
                 RowBox[{"PLOTTING", " ", "ELLIPTICITY", " ", "FIGURES"}], 
                 "*)"}], "Subsubsection"], "\[IndentingNewLine]", 
               RowBox[{"rwave", "=", 
                RowBox[{"Normalize", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"rmpw2", "[", "A", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"rmpw1", "[", "A", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"rmpw1", "[", "A", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"rmpw2", "[", "A", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "}"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{"\[CapitalDelta]\[Delta]", "\[Rule]", 
                    RowBox[{"delta", " ", "Degree"}]}], "}"}]}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"twave", "=", 
                RowBox[{"Normalize", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tmpw2", "[", "A", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"tmpw1", "[", "A", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tmpw1", "[", "A", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"tmpw2", "[", "A", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "}"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{"\[CapitalDelta]\[Delta]", "\[Rule]", 
                    RowBox[{"delta", " ", "Degree"}]}], "}"}]}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"iwave", "=", 
                RowBox[{"Normalize", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"wInc", "[", "A", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"wInc", "[", "A", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{"\[CapitalDelta]\[Delta]", "\[Rule]", 
                    RowBox[{"delta", " ", "Degree"}]}], "}"}]}], "]"}]}], ";",
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"ellipticityfig", "=", "\[IndentingNewLine]", 
                RowBox[{"If", " ", "[", 
                 RowBox[{"RotatePolarizer", ",", "\[IndentingNewLine]", " ", 
                  RowBox[{"ParametricPlot", "[", 
                   RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", " ", "z"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"iwave", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"iwave", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "/.", 
                    RowBox[{"\[CurlyPhi]", "->", 
                    RowBox[{"phi", " ", "Degree"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", " ", "z"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rwave", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"rwave", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "/.", 
                    RowBox[{"\[CurlyPhi]", "->", 
                    RowBox[{"phi", " ", "Degree"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", " ", "z"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"twave", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"twave", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "/.", 
                    RowBox[{"\[CurlyPhi]", "->", 
                    RowBox[{"phi", " ", "Degree"}]}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", 
                    RowBox[{"2", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "@", "options3"}]}], "]"}], 
                  "\[IndentingNewLine]", ",", "\[IndentingNewLine]", " ", 
                  RowBox[{"ParametricPlot", "[", 
                   RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", " ", "z"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"iwave", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"iwave", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", " ", "z"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rwave", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"rwave", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", " ", "z"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"twave", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"twave", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", 
                    RowBox[{"2", "Pi"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Evaluate", "@", "options3"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
               ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"clearFigs", "[", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Print", "@", 
                RowBox[{"Style", "[", 
                 RowBox[{
                 "\"\<SHG Simulation can only be used for numerical \
simulation; Either analytical d or h is given! Not plotting!\>\"", " ", ",", 
                  "Bold", ",", "Red", ",", "32"}], "]"}]}]}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"(*", 
            RowBox[{
            "For", " ", "Partial", " ", "Analytical", " ", "Expressions"}], 
            "*)"}], "Section"], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
            "Functionality", "==", "\"\<Partial Analytical Expressions\>\""}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rules", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[CapitalDelta]\[Delta]", "\[Rule]", 
                 RowBox[{"delta", " ", "Degree"}]}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{"RotatePolarizer", ",", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{"\[CurlyPhi]", "->", 
                   RowBox[{"phi", " ", "Degree"}]}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{"RotateAnalyzer", ",", 
                  RowBox[{"\[Psi]", "->", 
                   RowBox[{"\[CurlyPhi]", "+", 
                    RowBox[{"analyzeroffset", " ", "Degree"}]}]}], ",", 
                  RowBox[{"\[Psi]", "->", 
                   RowBox[{"psi", " ", "Degree"}]}]}], "]"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"for", " ", "the", " ", "linear", " ", "part"}], ",", 
               " ", 
               RowBox[{"i", ".", "e", "."}], ",", " ", 
               RowBox[{
               "Fresnel", " ", "coefficients", " ", "for", " ", "one", " ", 
                "incident", " ", "angle"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"rmpw1L", ",", "rmpw2L"}], "}"}], "=", 
              RowBox[{"wavL", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "is", " ", "for", " ", 
                "reflected"}], ",", " ", 
               RowBox[{
                RowBox[{"[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "is", " ", "for", " ", 
                "transmitted"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"extWave", "@", "rmpw1L"}], ";", 
             RowBox[{"extWave", "@", "rmpw2L"}], ";", "\[IndentingNewLine]", 
             RowBox[{"rSignalL", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rmpw1L", "[", "A", "]"}], "+", 
                 RowBox[{"rmpw2L", "[", "A", "]"}]}], ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"tmpw1L", ",", "tmpw2L"}], "}"}], "=", 
              RowBox[{"wavL", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "is", " ", "for", " ", 
                "reflected"}], ",", " ", 
               RowBox[{
                RowBox[{"[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "is", " ", "for", " ", 
                "transmitted"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"extWave", "@", "tmpw1L"}], ";", 
             RowBox[{"extWave", "@", "tmpw2L"}], ";", "\[IndentingNewLine]", 
             RowBox[{"tSignalL", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"tmpw1L", "[", "A", "]"}], "+", 
                 RowBox[{"tmpw2L", "[", "A", "]"}]}], ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"dataRpL", "=", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"rSignalL", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{"rSignalL", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], 
             RowBox[{"(*", 
              RowBox[{"/.", "rules"}], "*)"}], ";", "\[IndentingNewLine]", 
             RowBox[{"dataRsL", "=", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"rSignalL", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "*", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{"rSignalL", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}], 
             RowBox[{"(*", 
              RowBox[{"/.", "rules"}], "*)"}], ";", "\[IndentingNewLine]", 
             RowBox[{"dataTpL", "=", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"tSignalL", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{"tSignalL", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], 
             RowBox[{"(*", 
              RowBox[{"/.", "rules"}], "*)"}], ";", "\[IndentingNewLine]", 
             RowBox[{"dataTsL", "=", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"tSignalL", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "*", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{"tSignalL", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}], 
             RowBox[{"(*", 
              RowBox[{"/.", "rules"}], "*)"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "equationRpL", ",", "equationRsL", ",", "equationTpL", ",", 
                "equationTsL"}], "}"}], "=", 
              RowBox[{"Re", "@", 
               RowBox[{"{", 
                RowBox[{
                "dataRpL", ",", "dataRsL", ",", "dataTpL", ",", "dataTsL"}], 
                "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "for", " ", "the", " ", "polarplot", " ", "of", " ", 
               "reflected", " ", "waves"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"rmpw1", ",", "rmpw2"}], "}"}], "=", 
              RowBox[{"wavNL", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "is", " ", "for", " ", 
                "reflected"}], ",", " ", 
               RowBox[{
                RowBox[{"[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "is", " ", "for", " ", 
                "transmitted"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"extWave", "@", "rmpw1"}], ";", 
             RowBox[{"extWave", "@", "rmpw2"}], ";", "\[IndentingNewLine]", 
             RowBox[{"rSignal", "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", "\[Psi]", "]"}], ",", 
                   RowBox[{"-", 
                    RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sin", "[", "\[Psi]", "]"}], ",", 
                   RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "}"}]}], "}"}], ".", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"rmpw1", "[", "A", "]"}], "+", 
                  RowBox[{"rmpw2", "[", "A", "]"}]}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "for", " ", "the", " ", "polarplot", " ", "of", " ", 
               "transmitive", " ", "waves"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"tmpw1", ",", "tmpw2"}], "}"}], "=", 
              RowBox[{"wavNL", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "is", " ", "for", " ", 
                "reflected"}], ",", " ", 
               RowBox[{
                RowBox[{"[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "is", " ", "for", " ", 
                "transmitted"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"extWave", "@", "tmpw1"}], ";", 
             RowBox[{"extWave", "@", "tmpw2"}], ";", "\[IndentingNewLine]", 
             RowBox[{"tSignal", "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", "\[Psi]", "]"}], ",", 
                   RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", 
                   RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "}"}]}], "}"}], ".", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"tmpw1", "[", "A", "]"}], "+", 
                  RowBox[{"tmpw2", "[", "A", "]"}]}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"dataRs", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rSignal", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "*", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{"rSignal", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "/.", 
               "rules"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dataRp", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rSignal", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{"rSignal", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}], "/.", 
               "rules"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dataTs", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"tSignal", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "*", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{"tSignal", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "/.", 
               "rules"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dataTp", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"tSignal", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{"tSignal", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}], "/.", 
               "rules"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "equationRp", ",", "equationRs", ",", "equationTp", ",", 
                "equationTs"}], "}"}], "=", 
              RowBox[{"Re", "@", 
               RowBox[{"{", 
                RowBox[{
                "dataRp", ",", "dataRs", ",", "dataTp", ",", "dataTs"}], 
                "}"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "equationRpL", ",", "equationRsL", ",", "equationTpL", ",", 
                "equationTsL"}], "}"}], "=", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"placeHolderEqus", ",", "4"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "equationRp", ",", "equationRs", ",", "equationTp", ",", 
                "equationTs"}], "}"}], "=", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"placeHolderEqus", ",", "4"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"progress", "=", "100"}], ";", "\[IndentingNewLine]", 
          RowBox[{"EndTime", "=", 
           RowBox[{"SessionTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"evaltime", "=", 
           RowBox[{"EndTime", "-", "StartTime"}]}], ";", 
          "\[IndentingNewLine]", "\"\<\>\""}], 
         RowBox[{"(*", 
          RowBox[{"Avoid", " ", "print", " ", "Null"}], "*)"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          StyleBox["CONTROLS", "Chapter",
           FontWeight->"Bold"], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Column", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["header1", "Input"], ",", "\[IndentingNewLine]", 
            RowBox[{"Grid", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Framed", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Functionality\>\"", ",", "18", ",", "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "Functionality", ",", "\"\<User Guide\>\"", ",", 
                    "\"\<\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<User Guide\>\"", ",", 
                    "\"\<Set Material Properties\>\"", ",", 
                    "\"\<SHG Simulation\>\"", ",", 
                    "\"\<Partial Analytical Expressions\>\""}], "}"}], ",", 
                    RowBox[{"Appearance", "->", "\"\<Row\>\""}]}], "}"}], 
                    "]"}], "}"}], ",", "Left", ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "16"}], "}"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}],
                     "\[Or]", 
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Set Material Properties\>\""}]}], ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"schematictype", ",", "1", ",", "\"\<\>\""}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<2D Schematics\>\"", ",", "Bold"}], "]"}]}], 
                    ",", 
                    RowBox[{"2", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<3D Schematics\>\"", ",", "Bold"}], "]"}]}]}],
                     "}"}], ",", 
                    RowBox[{"Appearance", "->", "\"\<Row\>\""}], ",", 
                    RowBox[{"ControlType", "->", "SetterBar"}]}], "}"}], 
                    "]"}]}], "}"}], ",", "Left", ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "14"}], "}"}]}]}], 
                    "]"}], ",", "\"\<\>\""}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
                    "True"}], "]"}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Set Material Properties\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Wavelength Setting\>\"", ",", "18", ",", "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[Lambda]", ",", "1.064", ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<Incident fundamental wavelength (\[Mu]m):\>\"", 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"ControlType", "->", "InputField"}], ",", 
                    RowBox[{"FieldSize", "->", "6"}]}], "}"}], "]"}], 
                    "\[IndentingNewLine]", "}"}], ",", "Left", ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "15"}], "}"}]}]}], 
                    "]"}]}], "}"}], ",", "True"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\"\<\>\""}], "]"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Set Material Properties\>\""}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Layer Selection:\>\"", ",", "18", ",", "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"materialnumber", ",", "1", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Number of Layers: \>\"", ",", "Bold"}], 
                    "]"}]}], "}"}], ",", "Number", ",", "InputField", ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Dynamic", "["}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"!", 
                    RowBox[{"IntegerQ", "[", "materialnumber", "]"}]}], ")"}],
                     ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<ERROR: The number of materials must be an integer.\>\
\"", ",", "Red", ",", "Bold"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"materialnumber", "<", "1"}], ")"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<ERROR: You need to use at least one material.\>\"", 
                    ",", "Red", ",", "Bold"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"materialnumber", ">", 
                    RowBox[{"maxmaterialnumber", "-", "2"}]}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<ERROR: The maximum number of materials is set at \
\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"maxmaterialnumber", "-", "2"}], "]"}], "<>", 
                    "\"\<.\>\""}], ",", "Red", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"matindex", ",", "2", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Select the layer to Edit : \>\"", ",", "Bold"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"Thread", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"materialnumber", "+", "1"}]}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{"ToString", "/@", 
                    RowBox[{"Range", "[", "materialnumber", "]"}]}], ")"}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Appearance", "->", "\"\<Row\>\""}], ",", 
                    RowBox[{"ControlType", "->", "SetterBar"}]}], "}"}], 
                    "]"}], ",", "\[IndentingNewLine]", "\"\<\>\""}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", "]", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<Layer \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"matindex", "-", "1"}], "]"}], "<>", 
                    "\"\< Name: \>\""}], "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "name", "]"}], "]"}], "]"}], "]"}], 
                    ",", "String", ",", 
                    RowBox[{"FieldSize", "->", "20"}], ",", 
                    RowBox[{"FieldHint", "->", "\"\<Enter name here\>\""}]}], 
                    "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
                    ",", "Left", ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}]}], 
                    "]"}]}], "}"}], ",", "True"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\"\<\>\""}], "]"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Set Material Properties\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Case Studies and Examples\>\"", ",", "18", ",", 
                    "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Blank linear\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{"blankMaterL", "[", "\[Lambda]", "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Blank nonlinear\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{"blankMaterNL", "[", "\[Lambda]", "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<BaTiO3\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{"BTO", "[", "\[Lambda]", "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Air\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{"Air", "[", "\[Lambda]", "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<LiNbO3(11\!\(\*OverscriptBox[\(2\), \(_\)]\)0)\>\"", 
                    ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{
                    "LiNbO3xCut\[Lambda]1550", "[", "\[Lambda]", "]"}]}]}], 
                    ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<LiNbO3(0001)\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{
                    "LiNbO3zCut\[Lambda]1550", "[", "\[Lambda]", "]"}]}]}], 
                    ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<KTP(100)\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{"KTPxCut", "[", "\[Lambda]", "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<KTP(010)\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{"KTPyCut", "[", "\[Lambda]", "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}]}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<ZnO(0001)\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{"ZnO001", "[", "\[Lambda]", "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Pt(111)\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{"Pt111\[Lambda]1550", "[", "\[Lambda]", "]"}]}]}],
                     ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(Al\), \
\(2\)]\)\!\(\*SubscriptBox[\(O\), \(3\)]\)(0001)\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{
                    "Al2O3$0001\[Lambda]1550", "[", "\[Lambda]", "]"}]}]}], 
                    ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<GaAs(111)\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{
                    "GaAs111\[Lambda]800", "[", "\[Lambda]", "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<X-cut Quartz\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{
                    "Quartz$xCut\[Lambda]1064", "[", "\[Lambda]", "]"}]}]}], 
                    ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Quartz(001)\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{
                    "Quartz$zCut\[Lambda]800", "[", "\[Lambda]", "]"}]}]}], 
                    ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Au Coating\>\"", ",", 
                    RowBox[{
                    RowBox[{"mtemp", "=", 
                    RowBox[{"setMater", "@", 
                    RowBox[{"Au\[Lambda]800", "[", "\[Lambda]", "]"}]}]}], 
                    ";", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", "mtemp"}], 
                    ";"}], ",", 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], "]"}]}], "\[IndentingNewLine]", "}"}], 
                    "]"}]}], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    StyleBox["}", "Input"]}], 
                    StyleBox[",", "Input"], 
                    StyleBox["Left", "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], ",", 
                    RowBox[{"FontFamily", "->", "\"\<Times New Roman\>\""}]}],
                     "}"}]}], "Input"]}], 
                    StyleBox["]", "Input"]}]}], 
                    StyleBox["}", "Input"]}], 
                    StyleBox[",", "Input"], 
                    StyleBox["True", "Input"]}], 
                    StyleBox["]", "Input"]}], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox["\"\<\>\"", "Input"]}], 
                    StyleBox["]", "Input"]}], 
                    StyleBox["]", "Input"]}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Calculation Controls\>\"", ",", "18", ",", "Bold", 
                    ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    RowBox[{
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"fresnelcontrol", ",", "False", ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<Generate Fresnel Coefficients Plot:\>\"", "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], 
                    ",", 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"makerfringescontrol", ",", "False", ",", 
                    RowBox[{
                    "Style", "[", "\"\<Generate Maker Fringes Plot:\>\"", 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}]}], 
                    "]"}]}], "}"}], ",", "True"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\"\<\>\""}], "]"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}],
                     "\[Or]", 
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Partial Analytical Expressions\>\""}]}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Assumptions\>\"", ",", "18", ",", "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Assumptions for Multiple Reflection: \>\"", ",", 
                    "Bold", ",", "14"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mrassumption", ",", "0", ",", "\"\<\>\""}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "0", "->", "\"\<Full Multiple Reflections (FMR)\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "1", "->", 
                    "\"\<Jerphagnon & Kurtz Assumption (No MR)\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "2", "->", 
                    "\"\<Herman & Hayden Assumption \\n (MR only for \
2\[Omega] Homo Waves)\>\""}]}], "}"}], ",", 
                    RowBox[{"Appearance", "->", "\"\<Vertical\>\""}]}], "}"}],
                     "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"mrassumption", "==", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Assumptions for 2\[Omega] Inhomogeneous Waves (for \
FMR only): \>\"", ",", "Bold", ",", "14"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"winhAssumption", ",", "1", ",", "\"\< \>\""}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0", "->", "\"\<Forward waves only\>\""}], ",", 
                    RowBox[{"1", "->", "\"\<Forward + Backward waves\>\""}], 
                    ",", 
                    RowBox[{
                    "2", "->", 
                    "\"\<Forward + Backward + Standing waves\>\""}]}], "}"}], 
                    ",", 
                    RowBox[{"Appearance", "->", "\"\<Vertical\>\""}]}], "}"}],
                     "]"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}]}], 
                    "]"}]}], "}"}], ",", "True"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\"\<\>\""}], "]"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}], 
                    RowBox[{"(*", 
                    RowBox[{"\[And]", 
                    RowBox[{"(", 
                    RowBox[{"makerfringescontrol", "==", "False"}], ")"}]}], 
                    "*)"}], ")"}], "\[Or]", 
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Partial Analytical Expressions\>\""}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Polarimetry Settings\>\"", ",", "18", ",", "Bold", 
                    ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Incident Angle \!\(\*SuperscriptBox[\(\[Theta]\), \
\(i\)]\) (\[Degree])\>\"", ",", " ", "Bold", ",", "14"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"theta", ",", "45.0", ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<\!\(\*SuperscriptBox[\(\[Theta]\), \(i\)]\) (\
\[Degree])\>\"", "]"}]}], "}"}], ",", "0.0", ",", "89.0", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ImageSize", "->", "340"}], ",", 
                    RowBox[{"ControlType", "->", "Slider"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<        \>\"", ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"theta", ",", "45", ",", "\"\<\>\""}], "}"}], ",",
                     "0", ",", "75", ",", "15", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ControlType", "\[Rule]", "SetterBar"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}], ",", 
                    RowBox[{"Appearance", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Row\>\"", ",", "\"\<FramedPalette\>\""}], 
                    "}"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\"\<     \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "theta", "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Alignment", "->", "Left"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Incident Field E = \!\(\*SubscriptBox[\(E\), \
\(0\)]\)\!\(\*TagBox[RowBox[{\\\" \\\", RowBox[{\\\"(\\\", \
\\\"\[NoBreak]\\\", TagBox[GridBox[{{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"\
\[CurlyPhi]\\\", \\\"]\\\"}]},{RowBox[{RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"\
\[CurlyPhi]\\\", \\\"]\\\"}], \\\"\[Application]\\\", \
SuperscriptBox[\\\"e\\\", RowBox[{\\\"i\\\", RowBox[{\\\"\[DifferenceDelta]\\\
\", \\\"\[Delta]\\\"}]}]]}]},{\\\"0\\\"}},GridBoxAlignment->{\\\"Columns\\\" \
-> {{Center}}, \\\"Rows\\\" -> \
{{Baseline}}},GridBoxSpacings->{\\\"Columns\\\" -> \
{Offset[0.27999999999999997`], {Offset[0.5599999999999999]}, \
Offset[0.27999999999999997`]}, \\\"Rows\\\" -> {Offset[0.2], {Offset[0.4]}, \
Offset[0.2]}}],Column], \\\"\[NoBreak]\\\", \
\\\")\\\"}]}],Function[BoxForm`e$, MatrixForm[BoxForm`e$]]]\)\>\"", ",", " ", 
                    "Bold", ",", "14"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"delta", ",", "0", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Incident Ellipticity \[CapitalDelta]\[Delta] \
\!\(\*SuperscriptBox[\((\), \(o\)]\)): \>\"", ",", "Bold"}], "]"}]}], "}"}], 
                    ",", "0", " ", ",", "360", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ImageSize", "->", "222"}], ",", 
                    RowBox[{"ControlType", "->", "Slider"}]}], "}"}], "]"}], 
                    "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<                                               \>\"",
                     ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "delta", "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}], "}"}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"RotatePolarizer", ",", "True", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Incident Polarization \
\[CurlyPhi]\!\(\*SuperscriptBox[\((\), \(o\)]\)): \>\"", ",", "Bold"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"True", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Rotate Polarizer\>\"", ",", "Bold"}], 
                    "]"}]}], ",", 
                    RowBox[{"False", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Fix Polarizer\>\"", ",", "Bold"}], "]"}]}]}],
                     "}"}]}], "}"}], "]"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    "RotatePolarizer", ",", "\"\< \>\"", "  ", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"phi", ",", "0", ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<Fixed Incident Polarization \
\[CurlyPhi]\!\(\*SuperscriptBox[\((\), \(o\)]\)): \>\"", "]"}]}], "}"}], ",", 
                    "0", ",", "360", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ImageSize", "->", "163"}], ",", 
                    RowBox[{"ControlType", "->", "Slider"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<        \>\"", ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"phi", ",", "45", ",", "\"\<\>\""}], "}"}], ",", 
                    "0", ",", "180", ",", "45", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ControlType", "\[Rule]", "SetterBar"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}], ",", 
                    RowBox[{"Appearance", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Row\>\"", ",", "\"\<FramedPalette\>\""}], 
                    "}"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\"\<     \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "phi", "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Alignment", "->", "Left"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{
                    "{", "\"\<For \[CurlyPhi] and \[Psi], 0\[Degree] refers \
to p- polarized, 90\[Degree] refers to s- polarized\>\"", "}"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "14"}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"phi", ",", "0", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Fixed Incident Polarization Angle \
\!\(\*SuperscriptBox[\((\), \(o\)]\)): \>\"", ",", "Bold"}], "]"}]}], "}"}], 
                    ",", "0", " ", ",", "360"}], "}"}], "]"}], "}"}], ",", 
                    RowBox[{"Background", "\[Rule]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{"RotatePolarizer", ",", "Red", ",", "LightBlue"}],
                     "]"}], "]"}]}]}], "]"}], ","}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"RotateAnalyzer", ",", "False", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<SHG Polarization \[Psi]\!\(\*SuperscriptBox[\((\), \
\(o\)]\)): \>\"", ",", "Bold"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"True", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Rotate Analyzer\>\"", ",", "Bold"}], "]"}]}],
                     ",", 
                    RowBox[{"False", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Fix Analyzer\>\"", ",", "Bold"}], "]"}]}]}], 
                    "}"}]}], "}"}], "]"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{"RotateAnalyzer", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"RotatePolarizer", ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"analyzeroffset", ",", "0", ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<Analyzer-Polarizer Angle Offset \
\!\(\*SuperscriptBox[\((\), \(o\)]\)): \>\"", "]"}]}], "}"}], ",", "0", ",", 
                    "180", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ControlType", "->", "Slider"}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "}"}], "]"}], " ", 
                    ",", "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"psi", ",", "0", ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<Fixed SHG Polarization \
\[Psi]\!\(\*SuperscriptBox[\((\), \(o\)]\)): \>\"", "]"}]}], "}"}], ",", "0", 
                    ",", "360", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ImageSize", "->", "235"}], ",", 
                    RowBox[{"ControlType", "->", "Slider"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<        \>\"", ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"psi", ",", "45", ",", "\"\<\>\""}], "}"}], ",", 
                    "0", ",", "180", ",", "45", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ControlType", "\[Rule]", "SetterBar"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}], ",", 
                    RowBox[{"Appearance", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Row\>\"", ",", "\"\<FramedPalette\>\""}], 
                    "}"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\"\<     \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "psi", "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Alignment", "->", "Left"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "]"}]}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"psi", ",", "0", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Fixed Output Analyzer Angle \!\(\*SuperscriptBox[\((\
\), \(o\)]\)): \>\"", ",", "Bold"}], "]"}]}], "}"}], ",", "0", " ", ",", 
                    "360"}], "}"}], "]"}], "}"}], ",", 
                    RowBox[{"Background", "\[Rule]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{"RotateAnalyzer", ",", "Red", ",", "LightBlue"}], 
                    "]"}], "]"}]}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
                    "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}],
                     "\[And]", 
                    RowBox[{"(", 
                    RowBox[{"makerfringescontrol", "==", "False"}], ")"}]}], 
                    ")"}], "\[Or]", 
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Partial Analytical Expressions\>\""}]}], ",", "True",
                     ",", "False"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
                    ",", "\"\<\>\""}], "]"}], "]"}], "\[IndentingNewLine]", 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}], 
                    RowBox[{"(*", 
                    RowBox[{"\[Or]", 
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Partial Analytical Expressions\>\""}]}], "*)"}], 
                    ")"}], "\[And]", 
                    RowBox[{"(", 
                    RowBox[{"fresnelcontrol", "==", "True"}], ")"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Fresnel Coefficients Collection Settings\>\"", ",", 
                    "18", ",", "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Step Size \!\(\*SuperscriptBox[\(\[Theta]\), \
\(i\)]\)(\[Degree])\>\"", ",", " ", "Bold", ",", "14"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<        \>\"", ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"thetastep1", ",", "2", ",", "\"\<\>\""}], "}"}], 
                    ",", "1", ",", "5", ",", "1", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ControlType", "\[Rule]", "SetterBar"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}], ",", 
                    RowBox[{"Appearance", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Row\>\"", ",", "\"\<FramedPalette\>\""}], 
                    "}"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\"\<     \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "thetastep1", "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}], "}"}], 
                    "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "->", "Left"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}]}], 
                    "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"fresnelcontrol", ",", "True", ",", "False"}], 
                    "]"}]}], "]"}], "\[IndentingNewLine]", ",", "\"\<\>\""}], 
                    "]"}], "]"}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}], 
                    RowBox[{"(*", 
                    RowBox[{"\[Or]", 
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Partial Analytical Expressions\>\""}]}], "*)"}], 
                    ")"}], 
                    RowBox[{"(*", 
                    RowBox[{"\[And]", 
                    RowBox[{"(", 
                    RowBox[{"makerfringescontrol", "==", "True"}], ")"}]}], 
                    "*)"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Maker Fringes Collection Settings\>\"", ",", "18", 
                    ",", "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Minimum Incident Angle \!\(\*SuperscriptBox[\(\
\[Theta]\), \(min\)]\) (\[Degree])\>\"", ",", " ", "Bold", ",", "14"}], "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mintheta2", ",", 
                    RowBox[{"-", "30"}], ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<\!\(\*SuperscriptBox[\(\[Theta]\), \(min\)]\) (\
\[Degree])\>\"", "]"}]}], "}"}], ",", 
                    RowBox[{"-", "90"}], ",", "0", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ImageSize", "->", "340"}], ",", 
                    RowBox[{"ControlType", "->", "Slider"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<        \>\"", ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mintheta2", ",", 
                    RowBox[{"-", "30"}], ",", "\"\<\>\""}], "}"}], ",", 
                    RowBox[{"-", "90"}], ",", "0", ",", "15", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ControlType", "\[Rule]", "SetterBar"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}], ",", 
                    RowBox[{"Appearance", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Row\>\"", ",", "\"\<FramedPalette\>\""}], 
                    "}"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\"\<     \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "mintheta2", "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}], "}"}], "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Maximum Incident Angle \!\(\*SuperscriptBox[\(\
\[Theta]\), \(max\)]\) (\[Degree])\>\"", ",", " ", "Bold", ",", "14"}], "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"maxtheta2", ",", "30", ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<\!\(\*SuperscriptBox[\(\[Theta]\), \(max\)]\) (\
\[Degree])\>\"", "]"}]}], "}"}], ",", "0", ",", "90", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ImageSize", "->", "340"}], ",", 
                    RowBox[{"ControlType", "->", "Slider"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<        \>\"", ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"maxtheta2", ",", "30", ",", "\"\<\>\""}], "}"}], 
                    ",", "0", ",", "90", ",", "15", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ControlType", "\[Rule]", "SetterBar"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}], ",", 
                    RowBox[{"Appearance", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Row\>\"", ",", "\"\<FramedPalette\>\""}], 
                    "}"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\"\<     \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "maxtheta2", "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}], "}"}], "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Scan Step Size (\[Degree])\>\"", ",", " ", "Bold", 
                    ",", "14"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<        \>\"", ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"thetastep2", ",", "1", ",", "\"\<\>\""}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "5", ",", "10", ",", "15"}], 
                    "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ControlType", "\[Rule]", "SetterBar"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}], ",", 
                    RowBox[{"Appearance", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Row\>\"", ",", "\"\<FramedPalette\>\""}], 
                    "}"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\"\<     \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "thetastep2", "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}], "}"}], "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Incident Field E = \!\(\*SubscriptBox[\(E\), \
\(0\)]\)\!\(\*TagBox[RowBox[{\\\" \\\", RowBox[{\\\"(\\\", \
\\\"\[NoBreak]\\\", TagBox[GridBox[{{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"\
\[CurlyPhi]\\\", \\\"]\\\"}]},{RowBox[{RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"\
\[CurlyPhi]\\\", \\\"]\\\"}], \\\"\[Application]\\\", \
SuperscriptBox[\\\"e\\\", RowBox[{\\\"i\\\", RowBox[{\\\"\[DifferenceDelta]\\\
\", \\\"\[Delta]\\\"}]}]]}]},{\\\"0\\\"}},GridBoxAlignment->{\\\"Columns\\\" \
-> {{Center}}, \\\"Rows\\\" -> \
{{Baseline}}},GridBoxSpacings->{\\\"Columns\\\" -> \
{Offset[0.27999999999999997`], {Offset[0.5599999999999999]}, \
Offset[0.27999999999999997`]}, \\\"Rows\\\" -> {Offset[0.2], {Offset[0.4]}, \
Offset[0.2]}}],Column], \\\"\[NoBreak]\\\", \
\\\")\\\"}]}],Function[BoxForm`e$, MatrixForm[BoxForm`e$]]]\)\>\"", ",", " ", 
                    "Bold", ",", "14"}], "]"}], ",", "\[IndentingNewLine]", 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"phi", ",", "0", ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<Fixed Incident Polarization \
\[CurlyPhi]\!\(\*SuperscriptBox[\((\), \(o\)]\)): \>\"", "]"}]}], "}"}], ",", 
                    "0", ",", "360", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ImageSize", "->", "163"}], ",", 
                    RowBox[{"ControlType", "->", "Slider"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<        \>\"", ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"phi", ",", "45", ",", "\"\<\>\""}], "}"}], ",", 
                    "0", ",", "180", ",", "45", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ControlType", "\[Rule]", "SetterBar"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}], ",", 
                    RowBox[{"Appearance", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Row\>\"", ",", "\"\<FramedPalette\>\""}], 
                    "}"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\"\<     \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "phi", "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Alignment", "->", "Left"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"psi", ",", "0", ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<Fixed SHG Polarization \
\[Psi]\!\(\*SuperscriptBox[\((\), \(o\)]\)): \>\"", "]"}]}], "}"}], ",", "0", 
                    ",", "360", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ImageSize", "->", "235"}], ",", 
                    RowBox[{"ControlType", "->", "Slider"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<        \>\"", ",", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"psi", ",", "45", ",", "\"\<\>\""}], "}"}], ",", 
                    "0", ",", "180", ",", "45", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ControlType", "\[Rule]", "SetterBar"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}], ",", 
                    RowBox[{"Appearance", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Row\>\"", ",", "\"\<FramedPalette\>\""}], 
                    "}"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\"\<     \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "psi", "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Alignment", "->", "Left"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{
                    "{", "\"\<For \[CurlyPhi] and \[Psi], 0\[Degree] refers \
to p- polarized, 90\[Degree] refers to s- polarized\>\"", "}"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "14"}]}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"delta", ",", "0", ",", 
                    RowBox[{
                    "Style", "[", 
                    "\"\<Incident Ellipticity \[CapitalDelta]\[Delta] \
\!\(\*SuperscriptBox[\((\), \(o\)]\)): \>\"", "]"}]}], "}"}], ",", 
                    RowBox[{"-", "90"}], " ", ",", "90", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ImageSize", "->", "222"}], ",", 
                    RowBox[{"ControlType", "->", "Slider"}]}], "}"}], "]"}], 
                    "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"delta", ",", "0", ",", "\"\<\>\""}], "}"}], ",", 
                    RowBox[{"-", "90"}], ",", "90", ",", "30", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"ControlType", "\[Rule]", "SetterBar"}], ",", 
                    RowBox[{"Background", "\[Rule]", "LightBlue"}], ",", 
                    RowBox[{"Appearance", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Row\>\"", ",", "\"\<FramedPalette\>\""}], 
                    "}"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\"\<     \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "delta", "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "5"}]}], "]"}]}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "->", "Left"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}]}], 
                    "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    "makerfringescontrol", ",", "True", ",", "False"}], 
                    "]"}]}], "]"}], "\[IndentingNewLine]", ",", "\"\<\>\""}], 
                    "]"}], "]"}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Set Material Properties\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Layer \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"matindex", "-", "1"}], "]"}], "<>", 
                    "\"\< Thickness\>\""}], ",", "18", ",", "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"matindex", "==", "1"}], "\[Or]", 
                    RowBox[{"matindex", "==", 
                    RowBox[{"materialnumber", "+", "2"}]}]}], ")"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<(No input: thickness of first and last material is \
infinite)\>\"", ",", "14"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "Style", "[", "\"\<Slab Thickness (\[Mu]m)   \>\"", "]"}],
                     ",", 
                    RowBox[{"Slider", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "h", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1000"}], "}"}], ",", 
                    RowBox[{"ImageSize", "->", "150"}]}], "]"}], ",", 
                    "\"\<   \>\"", "\[IndentingNewLine]", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "h", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}]}], ",", 
                    RowBox[{"FieldSize", "->", "4"}]}], "]"}], ",", 
                    "\"\<    \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<analytical h\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "h", "]"}], "]"}], "]"}], "=", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<h\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"matindex", "-", "1"}], "]"}]}], "]"}]}]}], 
                    "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
                    "]"}], "\[IndentingNewLine]", "}"}], ",", "Left", ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}]}], 
                    "]"}]}], "}"}], ",", "True"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\"\<\>\""}], "]"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Set Material Properties\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Layer \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"matindex", "-", "1"}], "]"}], "<>", 
                    "\"\< Crystal Structure\>\""}], ",", "18", ",", "Bold", 
                    ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Point Group:    \>\"", ",", "Bold", ",", "14"}], 
                    "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Noncentrosymmetric -> \>\"", ",", "14"}], 
                    "]"}], ",", 
                    RowBox[{"PopupMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "pg", "]"}], "]"}], "]"}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<1\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "11", ",", "12", ",", "13", ",", "14", ",", "15", ",", 
                    "16"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "21", ",", "22", ",", "23", ",", "24", ",", "25", ",", 
                    "26"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "31", ",", "32", ",", "33", ",", "34", ",", "35", ",", 
                    "36"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<1\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<2\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "14", ",", "0", ",", "16"}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "21", ",", "22", ",", "23", ",", "0", ",", "25", ",", 
                    "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "34", ",", "0", ",", "36"}],
                     "}"}]}], "}"}], ",", "1"}], "}"}], "->", "\"\<2\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "11", ",", "12", ",", "13", ",", "0", ",", "15", ",", 
                    "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "24", ",", "0", ",", "26"}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "31", ",", "32", ",", "33", ",", "0", ",", "35", ",", 
                    "0"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<m\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<mm2\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "15", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "24", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "31", ",", "32", ",", "33", ",", "0", ",", "0", ",", 
                    "0"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<mm2\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<222\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "14", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "25", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "36"}], 
                    "}"}]}], "}"}], ",", "1"}], "}"}], "->", "\"\<222\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<3\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"11", ",", 
                    RowBox[{"-", "11"}], ",", "0", ",", "14", ",", "15", ",", 
                    RowBox[{"-", "22"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "22"}], ",", "22", ",", "0", ",", "15", ",", 
                    RowBox[{"-", "14"}], ",", 
                    RowBox[{"-", "11"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "31", ",", "31", ",", "33", ",", "0", ",", "0", ",", 
                    "0"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<3\>\""}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<32\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"11", ",", 
                    RowBox[{"-", "11"}], ",", "0", ",", "14", ",", "0", ",", 
                    "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
                    RowBox[{"-", "14"}], ",", 
                    RowBox[{"-", "11"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "1"}], "}"}], "->", "\"\<32\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<3m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "15", ",", 
                    RowBox[{"-", "22"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "22"}], ",", "22", ",", "0", ",", "15", ",", 
                    "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "31", ",", "31", ",", "33", ",", "0", ",", "0", ",", 
                    "0"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<3m\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<4\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "14", ",", "15", ",", "0"}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "15", ",", 
                    RowBox[{"-", "14"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "31", ",", "31", ",", "33", ",", "0", ",", "0", ",", 
                    "0"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<4\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<6\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "14", ",", "15", ",", "0"}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "15", ",", 
                    RowBox[{"-", "14"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "31", ",", "31", ",", "33", ",", "0", ",", "0", ",", 
                    "0"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<6\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*OverscriptBox[\(4\), \(_\)]\)\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "14", ",", "15", 
                    ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", 
                    RowBox[{"-", "15"}], ",", "14", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"31", ",", 
                    RowBox[{"-", "31"}], ",", "0", ",", "0", ",", "0", ",", 
                    "36"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<\!\(\*OverscriptBox[\(4\), \(_\)]\)\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<4mm\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "15", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "15", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "31", ",", "31", ",", "33", ",", "0", ",", "0", ",", 
                    "0"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<4mm\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<6mm\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "15", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "15", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "31", ",", "31", ",", "33", ",", "0", ",", "0", ",", 
                    "0"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<6mm\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<422\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "14", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
                    RowBox[{"-", "14"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "1"}], "}"}], "->", "\"\<422\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<622\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "14", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
                    RowBox[{"-", "14"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "1"}], "}"}], "->", "\"\<622\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*OverscriptBox[\(4\), \(_\)]\)2m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "14", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "14", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "36"}], 
                    "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<\!\(\*OverscriptBox[\(4\), \(_\)]\)2m\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*OverscriptBox[\(6\), \(_\)]\)\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"11", ",", 
                    RowBox[{"-", "11"}], ",", "0", ",", "0", ",", "0", ",", 
                    RowBox[{"-", "22"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "22"}], ",", "22", ",", "0", ",", "0", ",", 
                    "0", ",", 
                    RowBox[{"-", "11"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<\!\(\*OverscriptBox[\(6\), \(_\)]\)\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*OverscriptBox[\(6\), \(_\)]\)2m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                    RowBox[{"-", "22"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "22"}], ",", "22", ",", "0", ",", "0", ",", 
                    "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<\!\(\*OverscriptBox[\(6\), \(_\)]\)2m\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*OverscriptBox[\(4\), \(_\)]\)3m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "14", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "14", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "14"}], 
                    "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<\!\(\*OverscriptBox[\(4\), \(_\)]\)3m\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<23\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "14", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "14", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "14"}], 
                    "}"}]}], "}"}], ",", "1"}], "}"}], "->", "\"\<23\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Infinity]\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "14", ",", "15", ",", "0"}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "15", ",", 
                    RowBox[{"-", "14"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "31", ",", "31", ",", "33", ",", "0", ",", "0", ",", 
                    "0"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<\[Infinity]\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Infinity]m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "15", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "15", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "31", ",", "31", ",", "33", ",", "0", ",", "0", ",", 
                    "0"}], "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<\[Infinity]m\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Infinity]2\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "14", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
                    RowBox[{"-", "14"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "1"}], "}"}], "->", 
                    "\"\<\[Infinity]2\>\""}]}], "\[IndentingNewLine]", "}"}], 
                    ",", "\"\<--\>\""}], "]"}]}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "Style", "[", 
                    "\"\<                                     \>\"", "]"}], 
                    ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Centrosymmetric -> \>\"", ",", "14"}], "]"}],
                     ",", 
                    RowBox[{"PopupMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "pg", "]"}], "]"}], "]"}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*OverscriptBox[\(1\), \(_\)]\)\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", 
                    "\"\<\!\(\*OverscriptBox[\(1\), \(_\)]\)\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<2/m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", "\"\<2/m\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<mmm\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", "\"\<mmm\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<4/m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", "\"\<4/m\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<4/mmm\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", 
                    "\"\<4/mmm\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", 
                    "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", 
                    "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)m\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<6/m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", "\"\<6/m\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<6/mmm\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", 
                    "\"\<6/mmm\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<m3\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", "\"\<m3\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<m3m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", "\"\<m3m\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<432\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", "\"\<432\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Infinity]/m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", 
                    "\"\<\[Infinity]/m\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Infinity]/mm\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", 
                    "\"\<\[Infinity]/mm\>\""}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Infinity]\[Infinity]\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", 
                    "\"\<\[Infinity]\[Infinity]\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Infinity]\[Infinity]m\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}]}], "}"}], ",", "0"}], "}"}], "->", 
                    "\"\<\[Infinity]\[Infinity]m\>\""}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "\"\<--\>\""}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<a = \>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "latcon", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<    b = \>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "latcon", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<    c = \>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "latcon", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}]}], "}"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<\[Alpha] = \>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "latcon", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<    \[Beta] = \>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "latcon", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<    \[Gamma] = \>\"", ",", "12"}], "]"}], 
                    ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "latcon", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}]}], "}"}], 
                    "]"}]}], "\[IndentingNewLine]", "}"}], ",", "Left", ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}]}], 
                    "]"}]}], "}"}], ",", "True"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\"\<\>\""}], "]"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Set Material Properties\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Layer \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"matindex", "-", "1"}], "]"}], "<>", 
                    "\"\< Crystal Orientation\>\""}], ",", "18", ",", "Bold", 
                    ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"SetterBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Use Miller Indices (hkl)\>\"", ",", "Bold"}],
                     "]"}]}], ",", 
                    RowBox[{"2", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Use Crystal Physics Direction\>\"", ",", "Bold"}], 
                    "]"}]}]}], "}"}]}], "]"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<?(hkl)\>\"", ",", "Black", ",", "Bold", ",", "11"}], 
                    "]"}], ",", "hklExplain"}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "3", "]"}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<?Crystal Physics\>\"", ",", "Black", ",", "Bold", 
                    ",", "11"}], "]"}], ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"StringJoin", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", "pg", "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<: \>\"", ",", 
                    RowBox[{"ZSysExplain", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", "pg", "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
                    "\"\<Times New Roman\>\"", ",", "20"}], "]"}], "]"}]}], 
                    "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "Style", "[", 
                    "\"\<\!\(\*SubscriptBox[\(Z\), \(1\)]\) = { \>\"", "]"}], 
                    ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", "\"\< , \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    RowBox[{"Style", "[", "\"\< , \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\"\< }\>\""}], "}"}], "]"}], ",", 
                    RowBox[{"ZExplain", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", "pg", "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "Style", "[", 
                    "\"\<\!\(\*SubscriptBox[\(Z\), \(2\)]\) = { \>\"", "]"}], 
                    ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", "\"\< , \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    RowBox[{"Style", "[", "\"\< , \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\"\< }\>\""}], "}"}], "]"}], ",", 
                    RowBox[{"ZExplain", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", "pg", "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "Style", "[", 
                    "\"\<\!\(\*SubscriptBox[\(Z\), \(3\)]\) = { \>\"", "]"}], 
                    ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", "\"\< , \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    RowBox[{"Style", "[", "\"\< , \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\"\< }\>\""}], "}"}], "]"}], ",", 
                    RowBox[{"ZExplain", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", "pg", "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<(hkl) \[Rule] Crystal Surface Plane: \>\"", ",", 
                    "Bold"}], "]"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", "\"\<h = \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", "\"\<,  k = \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", "\"\<,  l = \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}]}], "}"}], 
                    "]"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<[hkl] \[Rule] Direction Perpendicular to Plane of \
Incidence\>\"", ",", "Bold"}], "]"}], "]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", "\"\<h = \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", "\"\<,  k = \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", "\"\<,  l = \>\"", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "5"}]}], "]"}]}], "}"}], 
                    "]"}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "->", "Left"}]}], "]"}], "}"}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ")"}], ",", 
                    "\[IndentingNewLine]", "\"\<\>\"", "\[IndentingNewLine]", 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ".", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "==", "0"}], 
                    ")"}], "\[And]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ".", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "==", "0"}], 
                    ")"}], "\[And]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ".", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "==", "0"}], 
                    ")"}]}], ",", "\"\<\>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<ERROR: The crystal physics basis vectors are not \
orthogonal.\>\"", ",", "Red", ",", "Bold"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ")"}], ",", 
                    "\"\<\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Cross]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "6"}], 
                    "]"}], "==", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "orientation", "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "6"}], 
                    "]"}]}], ")"}], ",", "\[IndentingNewLine]", "\"\<\>\"", 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<ERROR: The crystal physics basis vectors are not \
right-handed.\>\"", ",", "Red", ",", "Bold"}], "]"}]}], "]"}]}], "]"}], 
                    "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "Left", ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}]}], 
                    "]"}]}], "}"}], ",", "True"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\"\<\>\""}], "]"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Set Material Properties\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Layer \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"matindex", "-", "1"}], "]"}], "<>", 
                    "\"\< Dielectric Tensors \
(\!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), \(\[Omega]\)], \
\(ij\)]\) and \!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), \(2  \
\[Omega]\)], \(ij\)]\))\>\""}], ",", "18", ",", "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\< \!\(\*SubsuperscriptBox[\(\[CurlyEpsilon]\), \
\(ij\), \(\[Omega]\)]\) = \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"MatrixForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "\[CurlyEpsilon]\[Omega]C", "]"}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "##"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"FieldSize", "->", "9"}]}], "]"}], "&"}], ",", 
                    " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                    RowBox[{"Spacings", "->", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                    RowBox[{"ItemSize", "->", "All"}]}], "]"}], ",", 
                    "\"\<\>\""}], "}"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<  \!\(\*SubsuperscriptBox[\(\[CurlyEpsilon]\), \
\(ij\), \(2  \[Omega]\)]\) = \>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"MatrixForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "\[CurlyEpsilon]2\[Omega]C", "]"}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "##"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"FieldSize", "->", "9"}]}], "]"}], "&"}], ",", 
                    " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                    RowBox[{"Spacings", "->", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                    RowBox[{"ItemSize", "->", "All"}]}], "]"}], ",", 
                    "\"\<\>\""}], "}"}], "}"}], "]"}]}], "}"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}]}], 
                    "]"}]}], "}"}], ",", "True"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\"\<\>\""}], "]"}], "]"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Set Material Properties\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Layer \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"matindex", "-", "1"}], "]"}], "<>", 
                    "\"\< SHG Tensor \
(\!\(\*SubscriptBox[StyleBox[\\\"d\\\",FontSlant->\\\"Italic\\\"], \
\\\"ijk\\\"]\))\>\"", "<>", "\"\< pm/V\>\""}], ",", "18", ",", "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(d\), \(ij\)]\)=   \>\"", ",", 
                    RowBox[{"MatrixForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", "dgrid", ",", "\"\<\>\""}], 
                    "}"}], "}"}], "]"}], ",", "\"\<    \>\"", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<analytical dij\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "need", " ", "to", " ", "exclude", " ", "top", " ", "and",
                     " ", "bottom", " ", "layers", " ", "and", " ", "any", 
                    " ", "other", " ", "linear", " ", "materials", " ", 
                    "layers"}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "dC", "]"}], "]"}], "]"}], "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<m\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"matindex", "-", "1"}], "]"}]}], "]"}], ")"}], 
                    "&"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "d11", ",", "d12", ",", "d13", ",", "d14", ",", "d15", 
                    ",", "d16"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "d21", ",", "d22", ",", "d23", ",", "d24", ",", "d25", 
                    ",", "d26"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "d31", ",", "d32", ",", "d33", ",", "d34", ",", "d35", 
                    ",", "d36"}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"indexfun1", "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"materialnumber", "+", "2"}], "]"}]}], ";"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Key", "[", "pg", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "==", "1"}], ",", "True", 
                    ",", "False"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
                    ",", "\"\<\>\""}], "]"}], "]"}], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Set Material Properties\>\""}], ",", 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Layer Properties Preset Values\>\"", ",", "18", ",", 
                    "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Press update before setting any preset.\>\"", ",", 
                    "Blue", ",", "14"}], "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Preset 1\>\"", ",", "Bold", ",", "Black"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"ptest1", "=", "1"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval1", "]"}], ",", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", 
                    "presetval1"}], ",", 
                    RowBox[{"presetval1", "=", 
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}]}]}], "]"}]}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "ap1"}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Preset 2\>\"", ",", "Bold", ",", "Black"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"ptest2", "=", "1"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval2", "]"}], ",", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", 
                    "presetval2"}], ",", 
                    RowBox[{"presetval2", "=", 
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}]}]}], "]"}]}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "ap2"}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Preset 3\>\"", ",", "Bold", ",", "Black"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"ptest3", "=", "1"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval3", "]"}], ",", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", 
                    "presetval3"}], ",", 
                    RowBox[{"presetval3", "=", 
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}]}]}], "]"}]}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "ap3"}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Preset 4\>\"", ",", "Bold", ",", "Black"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"ptest4", "=", "1"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval4", "]"}], ",", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", 
                    "presetval4"}], ",", 
                    RowBox[{"presetval4", "=", 
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}]}]}], "]"}]}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "ap4"}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Preset 5\>\"", ",", "Bold", ",", "Black"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"ptest5", "=", "1"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval5", "]"}], ",", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", 
                    "presetval5"}], ",", 
                    RowBox[{"presetval5", "=", 
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}]}]}], "]"}]}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "ap5"}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Preset 6\>\"", ",", "Bold", ",", "Black"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"ptest6", "=", "1"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval6", "]"}], ",", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", 
                    "presetval6"}], ",", 
                    RowBox[{"presetval6", "=", 
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}]}]}], "]"}]}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "ap6"}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Preset 7\>\"", ",", "Bold", ",", "Black"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"ptest7", "=", "1"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval7", "]"}], ",", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", 
                    "presetval7"}], ",", 
                    RowBox[{"presetval7", "=", 
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}]}]}], "]"}]}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "ap7"}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Preset 8\>\"", ",", "Bold", ",", "Black"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"ptest8", "=", "1"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval8", "]"}], ",", 
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "=", 
                    "presetval8"}], ",", 
                    RowBox[{"presetval8", "=", 
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}]}]}], "]"}]}], ",", 
                    RowBox[{"Appearance", "\[Rule]", "ap8"}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Clear Presets\>\"", ",", "Bold"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "ptest1", ",", "ptest2", ",", "ptest3", ",", "ptest4", 
                    ",", "ptest5", ",", "ptest6", ",", "ptest7", ",", 
                    "ptest8"}], "}"}], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", "8"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "plabel1", ",", "plabel2", ",", "plabel3", ",", "plabel4",
                     ",", "plabel5", ",", "plabel6", ",", "plabel7", ",", 
                    "plabel8"}], "}"}], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\<Type Label Here\>\"", ",", "8"}], "]"}]}], 
                    ";", 
                    RowBox[{"Clear", "[", 
                    RowBox[{
                    "presetval1", ",", "presetval2", ",", "presetval3", ",", 
                    "presetval4", ",", "presetval5", ",", "presetval6", ",", 
                    "presetval7", ",", "presetval8"}], "]"}]}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}]}], 
                    "]"}], ",", 
                    RowBox[{"Spacer", "[", "5", "]"}]}], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    StyleBox["}", "Input"]}], 
                    StyleBox[",", "Input"], 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], 
                    StyleBox["]", "Input"]}], 
                    StyleBox[",", "Input"], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    RowBox[{
                    StyleBox["Row", "Input"], 
                    StyleBox["[", "Input"], 
                    RowBox[{
                    StyleBox["{", "Input"], 
                    RowBox[{
                    StyleBox[
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ptest1", "==", "1"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Preset 1 Label: \>\"", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "plabel1", "]"}], ",", "String"}],
                     "]"}]}], "}"}], "]"}], ",", "\"\<\>\""}], "]"}], "]"}], 
                    "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox[
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ptest2", "==", "1"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Preset 2 Label: \>\"", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "plabel2", "]"}], ",", "String"}],
                     "]"}]}], "}"}], "]"}], ",", "\"\<\>\""}], "]"}], "]"}], 
                    "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    StyleBox[
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ptest3", "==", "1"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Preset 3 Label: \>\"", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "plabel3", "]"}], ",", "String"}],
                     "]"}]}], "}"}], "]"}], ",", "\"\<\>\""}], "]"}], "]"}], 
                    "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox[
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ptest4", "==", "1"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Preset 4 Label: \>\"", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "plabel4", "]"}], ",", "String"}],
                     "]"}]}], "}"}], "]"}], ",", "\"\<\>\""}], "]"}], "]"}], 
                    "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox[
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ptest5", "==", "1"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Preset 5 Label: \>\"", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "plabel5", "]"}], ",", "String"}],
                     "]"}]}], "}"}], "]"}], ",", "\"\<\>\""}], "]"}], "]"}], 
                    "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox[
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ptest6", "==", "1"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Preset 6 Label: \>\"", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "plabel6", "]"}], ",", "String"}],
                     "]"}]}], "}"}], "]"}], ",", "\"\<\>\""}], "]"}], "]"}], 
                    "Input"], 
                    StyleBox[",", "Input"], 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ptest7", "==", "1"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Preset 7 Label: \>\"", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "plabel7", "]"}], ",", "String"}],
                     "]"}]}], "}"}], "]"}], ",", "\"\<\>\""}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ptest8", "==", "1"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Preset 8 Label: \>\"", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "plabel8", "]"}], ",", "String"}],
                     "]"}]}], "}"}], "]"}], ",", "\"\<\>\""}], "]"}], "]"}]}],
                     "}"}], "]"}], 
                    StyleBox[",", "Input"], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    RowBox[{"Toggler", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "presetpopuptextvar", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0", "->", "\"\<Show Preset Information\>\""}], 
                    ",", 
                    RowBox[{"1", "->", "\"\<Hide\>\""}]}], "}"}], ",", 
                    RowBox[{"Background", "->", "LightBlue"}], ",", 
                    RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"presetpopuptextvar", "==", "1"}], ",", 
                    RowBox[{"Style", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<Presets currently set:   \>\"", "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval1", "]"}], ",", 
                    "\"\<1   \>\"", ",", "\"\<\>\""}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval2", "]"}], ",", 
                    "\"\<2   \>\"", ",", "\"\<\>\""}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval3", "]"}], ",", 
                    "\"\<3   \>\"", ",", "\"\<\>\""}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval4", "]"}], ",", 
                    "\"\<4   \>\"", ",", "\"\<\>\""}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval5", "]"}], ",", 
                    "\"\<5   \>\"", ",", "\"\<\>\""}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval6", "]"}], ",", 
                    "\"\<6   \>\"", ",", "\"\<\>\""}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval7", "]"}], ",", 
                    "\"\<7   \>\"", ",", "\"\<\>\""}], "]"}], "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval8", "]"}], ",", 
                    "\"\<8   \>\"", ",", "\"\<\>\""}], "]"}], "<>", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ValueQ", "[", "presetval1", "]"}], "\[Or]", 
                    RowBox[{"ValueQ", "[", "presetval2", "]"}], "\[Or]", 
                    RowBox[{"ValueQ", "[", "presetval3", "]"}], "\[Or]", 
                    RowBox[{"ValueQ", "[", "presetval4", "]"}], "\[Or]", 
                    RowBox[{"ValueQ", "[", "presetval5", "]"}], "\[Or]", 
                    RowBox[{"ValueQ", "[", "presetval6", "]"}], "\[Or]", 
                    RowBox[{"ValueQ", "[", "presetval7", "]"}], "\[Or]", 
                    RowBox[{"ValueQ", "[", "presetval8", "]"}]}], ",", 
                    "\"\<\>\"", ",", "\"\<None.\>\""}], "]"}], "<>", 
                    "\[IndentingNewLine]", 
                    "\"\<\\nUpdate and press any of the preset buttons to \
save a material's \\ninformation to that preset. \\nPress the button again \
and update to apply those values.\\nHide and show this message to \
refresh.\>\""}], ",", "\"\<Times New Roman\>\"", ",", "12"}], "]"}], ",", 
                    "\"\<\>\""}], "]"}], "]"}]}], "\[IndentingNewLine]", 
                    StyleBox["}", "Input"]}], 
                    StyleBox[",", "Input"], 
                    StyleBox[
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "12"}], "}"}]}], 
                    "Input"]}], 
                    StyleBox["]", "Input"]}]}], 
                    StyleBox["}", "Input"]}], 
                    StyleBox[",", "Input"], 
                    StyleBox["False", "Input"]}], 
                    StyleBox["]", "Input"]}], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox["\"\<\>\"", "Input"]}], 
                    StyleBox["]", "Input"]}], 
                    StyleBox["]", "Input"]}], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    StyleBox[
                    RowBox[{"(*", 
                    RowBox[{
                    "add", " ", "another", " ", "update", " ", "button"}], 
                    "*)"}], "Input"], 
                    StyleBox["\[IndentingNewLine]", "Input"], 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1.8", ",", "0.7"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Inset", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Update\>\"", ",", "Black", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"Scaled", "[", ".27", "]"}]}], ",", 
                    RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
                    RowBox[{"Typeset`update$$", "=", 
                    RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
                    RowBox[{"Appearance", "->", "None"}]}], "]"}]}], 
                    StyleBox["\[IndentingNewLine]", "Input"], "}"}], ",", 
                    StyleBox[
                    RowBox[{"ItemSize", "\[Rule]", " ", "63"}], "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox[
                    RowBox[{"Background", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"White", ",", 
                    RowBox[{"GrayLevel", "[", "0.9", "]"}], ",", "White", ",", 
                    RowBox[{"GrayLevel", "[", "0.9", "]"}], ",", "White", ",", 
                    RowBox[{"GrayLevel", "[", "0.9", "]"}], ",", "White", ",", 
                    RowBox[{"GrayLevel", "[", "0.9", "]"}], ",", "White", ",", 
                    RowBox[{"GrayLevel", "[", "0.9", "]"}], ",", "White", ",", 
                    RowBox[{"GrayLevel", "[", "0.9", "]"}], ",", "White", ",", 
                    RowBox[{"GrayLevel", "[", "0.9", "]"}]}], "}"}]}], 
                    "Input"], 
                    StyleBox[" ", "Input"], 
                    StyleBox[",", "Input"], 
                    StyleBox[
                    RowBox[{"Frame", "\[Rule]", "All"}], "Input"]}], "]"}], 
                   ",", 
                   RowBox[{"Background", "->", "White"}], ",", 
                   RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  StyleBox["PLOTS", "Chapter",
                   FontWeight->"Bold"], "*)"}], "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"timecell", "=", 
                   RowBox[{"TextCell", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Time Used = \>\"", ",", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "evaltime", "]"}], ",", "5"}], 
                    "]"}], ",", "\"\< s\>\""}], "}"}], "]"}], ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", "20"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"Framed", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Functionality", "==", "\"\<User Guide\>\""}], 
                    ",", "\[IndentingNewLine]", "userguide", 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Set Material Properties\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<\>\"", ",", "30"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", "heterostructureschematic", "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"schematictype", "==", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<Layer \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"matindex", "-", "1"}], "]"}], "<>", 
                    "\"\< : \>\""}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"zvecplots2d", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], ",", 
                    RowBox[{"ZExplain", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", "pg", "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], 
                    "]"}], ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<Layer \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"matindex", "-", "1"}], "]"}], "<>", 
                    "\"\< : \>\""}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"zvecplots3d", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], ",", 
                    RowBox[{"ZExplain", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allmaterials", "[", 
                    RowBox[{"[", "matindex", "]"}], "]"}], "[", "pg", "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], 
                    "]"}]}], "]"}], "}"}], "}"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FontSize", "->", "24"}], ",", 
                    RowBox[{"FontFamily", "->", "\"\<Times New Roman\>\""}]}],
                     "}"}]}]}], "]"}], "}"}]}], "\[IndentingNewLine]", "}"}], 
                    "]"}]}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<\>\"", ",", "30"}], "]"}], ",", 
                    "\[IndentingNewLine]", "timecell", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<\\n\>\"", ",", "30"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1.8", ",", "0.7"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Inset", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Update\>\"", ",", "Black", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"Scaled", "[", ".27", "]"}]}], ",", 
                    RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
                    RowBox[{"Typeset`update$$", "=", 
                    RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
                    RowBox[{"Appearance", "->", "None"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "->", "Center"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Functionality", "==", "\"\<SHG Simulation\>\""}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<\>\"", ",", "30"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Optical Geometry and Polarization\>\"", ",", "30", 
                    ",", "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"schematictype", "==", "1"}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"fig12d", ",", "PropagationExplain"}], "]"}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"fig13d", ",", "PropagationExplain"}], "]"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"schematictype", "==", "1"}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"plot2geometry2d", ",", "GeometryExplain"}], 
                    "]"}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"plot2geometry3d", ",", "GeometryExplain"}], 
                    "]"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"ellipticityfig", ",", "EllipticityExplain"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"schematictype", "==", "1"}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"polarizationplot2d", ",", "GeometryExplain"}], 
                    "]"}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"polarizationplot3d", ",", "GeometryExplain"}], 
                    "]"}]}], "]"}]}], "}"}]}], "}"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"makerfringescontrol", "||", "fresnelcontrol"}], 
                    ",", "False", ",", "True"}], "]"}]}], "]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Polar Plots\>\"", ",", "30", ",", "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"\"\<Assumption Used: \>\"", "<>", 
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{"mrassumption", "==", "0"}], ",", 
                    "\"\<Full Multiple Reflection\>\"", ",", 
                    RowBox[{"mrassumption", "==", "1"}], ",", 
                    "\"\<Jerphagnon & Kurtz Assumption\>\"", ",", 
                    RowBox[{"mrassumption", "==", "2"}], ",", 
                    "\"\<Herman & Hayden Assumption\>\""}], "]"}], "<>", 
                    "\"\<\\n\>\"", "<>", 
                    "\"\<Consider Backward Wave (for FMR only)? \>\"", "<>", 
                    RowBox[{"ToString", "[", "flagBackward", "]"}], "<>", 
                    "\"\<\\n\>\"", "<>", 
                    "\"\<Consider Standing Wave (for FMR only)? \>\"", "<>", 
                    RowBox[{"ToString", "[", "flagStandingWave", "]"}]}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FontFamily", "->", "\"\<Times New Roman\>\""}], 
                    ",", 
                    RowBox[{"FontSize", "->", "22"}]}], "}"}]}]}], "]"}], ",",
                     "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"figRp", ",", "PolarPlotExplain"}], "]"}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"figRs", ",", "PolarPlotExplain"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Copy \!\(\*SuperscriptBox[\(I\), \(R, 2  \[Omega]\)]\
\)(\[CurlyPhi],\[Psi])\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "polarRp", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}], ",", 
                    RowBox[{"ImageSize", "->", "100"}]}], "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Copy \!\(\*SuperscriptBox[\(I\), \(R, 2  \[Omega]\)]\
\)(\[CurlyPhi],\[Psi]+\!\(\*FractionBox[\(\[Pi]\), \(2\)]\))\>\"", ",", 
                    "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "polarRs", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}], ",", 
                    RowBox[{"ImageSize", "->", "100"}]}], "]"}]}], "}"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"figTp", ",", "PolarPlotExplain"}], "]"}], ",", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{"figTs", ",", "PolarPlotExplain"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Copy \!\(\*SuperscriptBox[\(I\), \(T, 2  \[Omega]\)]\
\)(\[CurlyPhi],\[Psi])\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "polarTp", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}], ",", 
                    RowBox[{"ImageSize", "->", "100"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Copy \!\(\*SuperscriptBox[\(I\), \(T, 2  \[Omega]\)]\
\)(\[CurlyPhi],\[Psi]+\!\(\*FractionBox[\(\[Pi]\), \(2\)]\))\>\"", ",", 
                    "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "polarTs", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}], ",", 
                    RowBox[{"ImageSize", "->", "100"}]}], "]"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"makerfringescontrol", "||", "fresnelcontrol"}], 
                    ",", "False", ",", "True"}], "]"}]}], "]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Fresnel Coefficients Figure\>\"", ",", "30", ",", 
                    "Bold", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "figfresnel", ",", "SpanFromLeft", ",", "SpanFromLeft", 
                    ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Copy \!\(\*SubscriptBox[\(R\), \(p\)]\)\>\"", ",", 
                    "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", 
                    RowBox[{"listFresnel", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}], ",", 
                    RowBox[{"ImageSize", "->", "100"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Copy \!\(\*SubscriptBox[\(R\), \(s\)]\)\>\"", ",", 
                    "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", 
                    RowBox[{"listFresnel", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}], ",", 
                    RowBox[{"ImageSize", "->", "100"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Copy \!\(\*SubscriptBox[\(T\), \(p\)]\)\>\"", ",", 
                    "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", 
                    RowBox[{"listFresnel", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}], ",", 
                    RowBox[{"ImageSize", "->", "100"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Copy \!\(\*SubscriptBox[\(T\), \(s\)]\)\>\"", ",", 
                    "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", 
                    RowBox[{"listFresnel", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}], ",", 
                    RowBox[{"ImageSize", "->", "100"}]}], "]"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "fresnelcontrol"}], 
                    "]"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Maker Fringes Figures\>\"", ",", "30", ",", "Bold", 
                    ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"\"\<Assumption Used: \>\"", "<>", 
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{"mrassumption", "==", "0"}], ",", 
                    "\"\<Full Multiple Reflection\>\"", ",", 
                    RowBox[{"mrassumption", "==", "1"}], ",", 
                    "\"\<Jerphagnon & Kurtz Assumption\>\"", ",", 
                    RowBox[{"mrassumption", "==", "2"}], ",", 
                    "\"\<Herman & Hayden Assumption\>\""}], "]"}], "<>", 
                    "\"\<\\n\>\"", "<>", 
                    "\"\<Consider Backward Wave (for FMR only)? \>\"", "<>", 
                    RowBox[{"ToString", "[", "flagBackward", "]"}], "<>", 
                    "\"\<\\n\>\"", "<>", 
                    "\"\<Consider Standing Wave (for FMR only)? \>\"", "<>", 
                    RowBox[{"ToString", "[", "flagStandingWave", "]"}]}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FontFamily", "->", "\"\<Times New Roman\>\""}], 
                    ",", 
                    RowBox[{"FontSize", "->", "22"}]}], "}"}]}]}], "]"}], ",",
                     "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"GraphicsGrid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "figmakerfringespar", "}"}], ",", 
                    RowBox[{"{", "figmakerfringesperp", "}"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
                    "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Copy \!\(\*SuperscriptBox[\(I\), \(T, 2  \[Omega]\)]\
\)(\!\(\*SuperscriptBox[\(\[Theta]\), \(i\)]\),\[CurlyPhi],\[Psi])\>\"", ",", 
                    "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "listMFpara", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}], ",", 
                    RowBox[{"ImageSize", "->", "200"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Copy \!\(\*SuperscriptBox[\(I\), \(T, 2  \[Omega]\)]\
\)(\!\(\*SuperscriptBox[\(\[Theta]\), \
\(i\)]\),\[CurlyPhi],\[Psi]+90\[Degree])\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "listMFperp", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}], ",", 
                    RowBox[{"ImageSize", "->", "200"}]}], "]"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    "makerfringescontrol"}], "]"}], "}"}]}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{"OpenerView", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Maker Fringes Figures\>\"", ",", "30", ",", "Bold", 
                    ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Franklin Gothic\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Overlay", "[", 
                    RowBox[{"{", 
                    RowBox[{"figmakerfringespar", ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"\"\<\>\"", ",", "21"}], "]"}], "~", "Join", "~", 
                    RowBox[{"{", "figmakerfringesperp", "}"}]}], "]"}]}], 
                    "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    "makerfringescontrol", ",", "True", ",", "False"}], 
                    "]"}]}], "]"}], "}"}], "*)"}], "\[IndentingNewLine]", 
                    "}"}], ",", 
                    RowBox[{"Alignment", "->", "Left"}]}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<\>\"", ",", "30"}], "]"}], ",", 
                    "\[IndentingNewLine]", "timecell", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<\\n\>\"", ",", "30"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1.8", ",", "0.7"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Inset", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Update\>\"", ",", "Black", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"Scaled", "[", ".27", "]"}]}], ",", 
                    RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
                    RowBox[{"Typeset`update$$", "=", 
                    RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
                    RowBox[{"Appearance", "->", "None"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", "noAnalytical"}], ",", 
                    RowBox[{"Framed", "@", 
                    RowBox[{"Text", "@", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<SHG Simulation can only be used for numerical \
simulation; Either analytical d or h is given! Not plotting!\>\"", " ", ",", 
                    "Bold", ",", "Red", ",", "32", ",", 
                    RowBox[{"TextAlignment", "->", "Center"}]}], "]"}]}]}], 
                    ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
                    "}"}], ",", 
                    RowBox[{"Alignment", "->", "Center"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "Functionality", "==", 
                    "\"\<Partial Analytical Expressions\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<\>\"", ",", "30"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<For \[Omega] homogeneous waves:\>\"", ",", "Bold", 
                    ",", "Red", ",", "32"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Export\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Export", "[", 
                    RowBox[{
                    RowBox[{"SystemDialogInput", "[", 
                    RowBox[{"\"\<FileSave\>\"", ",", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<equationRpL.mx\>\""}], "}"}], "]"}]}], "]"}], ",", 
                    "equationRpL", ",", "\"\<mx\>\""}], "]"}]}], ",", 
                    RowBox[{"Method", "->", "\"\<Queued\>\""}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Copy\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "equationRpL", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}]}], 
                    "]"}], ",", 
                    RowBox[{"TextGrid", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<(\!\(\*SuperscriptBox[\(I\), \(R, \[Omega]\)]\)(\
\[CurlyPhi],\[Psi])\>\"", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\< = \>\"", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ByteCount", "[", "equationRpL", "]"}], ">", 
                    "equByteLimit"}], ",", 
                    RowBox[{
                    "TextCell", "[", "\"\<Too long to show\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "@", 
                    RowBox[{"MatrixForm", "@", "equationRpL"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}]}], "}"}], 
                    "}"}], "]"}]}], "}"}], "}"}], ",", 
                    RowBox[{"Alignment", "->", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Export\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Export", "[", 
                    RowBox[{
                    RowBox[{"SystemDialogInput", "[", 
                    RowBox[{"\"\<FileSave\>\"", ",", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<equationRsL.mx\>\""}], "}"}], "]"}]}], "]"}], ",", 
                    "equationRsL", ",", "\"\<mx\>\""}], "]"}]}], ",", 
                    RowBox[{"Method", "->", "\"\<Queued\>\""}]}], "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Copy\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "equationRsL", "]"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", " ", 
                    "\"\<DialogBox\>\""}]}], "]"}], ",", 
                    RowBox[{"TextGrid", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(R, \[Omega]\)]\)(\
\[CurlyPhi],\[Psi]+\!\(\*FractionBox[\(\[Pi]\), \(2\)]\))\>\"", ",", "Black", 
                    ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\< = \>\"", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ByteCount", "[", "equationRsL", "]"}], ">", 
                    "equByteLimit"}], ",", 
                    RowBox[{
                    "TextCell", "[", "\"\<Too long to show\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "@", 
                    RowBox[{"MatrixForm", "@", "equationRsL"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}]}], "}"}], 
                    "}"}], "]"}]}], "}"}], "}"}], ",", 
                    RowBox[{"Alignment", "->", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Export\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Export", "[", 
                    RowBox[{
                    RowBox[{"SystemDialogInput", "[", 
                    RowBox[{"\"\<FileSave\>\"", ",", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<equationTpL.mx\>\""}], "}"}], "]"}]}], "]"}], ",", 
                    "equationTpL", ",", "\"\<mx\>\""}], "]"}]}], ",", 
                    RowBox[{"Method", "->", "\"\<Queued\>\""}]}], "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Copy\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "equationTpL", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}]}], 
                    "]"}], ",", 
                    RowBox[{"TextGrid", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(T, \[Omega]\)]\)(\
\[CurlyPhi],\[Psi])\>\"", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\< = \>\"", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ByteCount", "[", "equationTpL", "]"}], ">", 
                    "equByteLimit"}], ",", 
                    RowBox[{
                    "TextCell", "[", "\"\<Too long to show\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "@", 
                    RowBox[{"MatrixForm", "@", "equationTpL"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}]}], "}"}], 
                    "}"}], "]"}]}], "}"}], "}"}], ",", 
                    RowBox[{"Alignment", "->", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Export\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Export", "[", 
                    RowBox[{
                    RowBox[{"SystemDialogInput", "[", 
                    RowBox[{"\"\<FileSave\>\"", ",", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<equationTsL.mx\>\""}], "}"}], "]"}]}], "]"}], ",", 
                    "equationTsL", ",", "\"\<mx\>\""}], "]"}]}], ",", 
                    RowBox[{"Method", "->", "\"\<Queued\>\""}]}], "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Copy\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "equationTsL", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}]}], 
                    "]"}], ",", 
                    RowBox[{"TextGrid", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(T, \[Omega]\)]\)(\
\[CurlyPhi],\[Psi]+\!\(\*FractionBox[\(\[Pi]\), \(2\)]\))\>\"", ",", "Black", 
                    ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\< = \>\"", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ByteCount", "[", "equationTsL", "]"}], ">", 
                    "equByteLimit"}], ",", 
                    RowBox[{
                    "TextCell", "[", "\"\<Too long to show\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "@", 
                    RowBox[{"MatrixForm", "@", "equationTsL"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}]}], "}"}], 
                    "}"}], "]"}]}], "}"}], "}"}], ",", 
                    RowBox[{"Alignment", "->", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<For 2\[Omega] homogeneous waves:\>\"", ",", "Bold", 
                    ",", "Blue", ",", "32"}], "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Export\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Export", "[", 
                    RowBox[{
                    RowBox[{"SystemDialogInput", "[", 
                    RowBox[{"\"\<FileSave\>\"", ",", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<equationRp.mx\>\""}], "}"}], "]"}]}], "]"}], ",", 
                    "equationRp", ",", "\"\<mx\>\""}], "]"}]}], ",", 
                    RowBox[{"Method", "->", "\"\<Queued\>\""}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Copy\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "equationRp", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}]}], 
                    "]"}], ",", 
                    RowBox[{"TextGrid", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(R, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi])\>\"", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\< = \>\"", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ByteCount", "[", "equationRp", "]"}], ">", 
                    "equByteLimit"}], ",", 
                    RowBox[{
                    "TextCell", "[", "\"\<Too long to show\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "@", 
                    RowBox[{"MatrixForm", "@", "equationRp"}]}]}], "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}]}], "}"}], 
                    "}"}], "]"}]}], "}"}], "}"}], ",", 
                    RowBox[{"Alignment", "->", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Export\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Export", "[", 
                    RowBox[{
                    RowBox[{"SystemDialogInput", "[", 
                    RowBox[{"\"\<FileSave\>\"", ",", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<equationRs.mx\>\""}], "}"}], "]"}]}], "]"}], ",", 
                    "equationRs", ",", "\"\<mx\>\""}], "]"}]}], ",", 
                    RowBox[{"Method", "->", "\"\<Queued\>\""}]}], "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Copy\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "equationRs", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}]}], 
                    "]"}], ",", 
                    RowBox[{"TextGrid", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(R, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi]+\!\(\*FractionBox[\(\[Pi]\), \(2\)]\))\>\"", ",", "Black", 
                    ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\< = \>\"", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ByteCount", "[", "equationRs", "]"}], ">", 
                    "equByteLimit"}], ",", 
                    RowBox[{
                    "TextCell", "[", "\"\<Too long to show\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "@", 
                    RowBox[{"MatrixForm", "@", "equationRs"}]}]}], "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}]}], "}"}], 
                    "}"}], "]"}]}], "}"}], "}"}], ",", 
                    RowBox[{"Alignment", "->", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Export\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Export", "[", 
                    RowBox[{
                    RowBox[{"SystemDialogInput", "[", 
                    RowBox[{"\"\<FileSave\>\"", ",", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<equationTp.mx\>\""}], "}"}], "]"}]}], "]"}], ",", 
                    "equationTp", ",", "\"\<mx\>\""}], "]"}]}], ",", 
                    RowBox[{"Method", "->", "\"\<Queued\>\""}]}], "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Copy\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "equationTp", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}]}], 
                    "]"}], ",", 
                    RowBox[{"TextGrid", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(T, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi])\>\"", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\< = \>\"", ",", "Black", ",", 
                    RowBox[{"FontFamily", "\[Rule]", 
                    "\"\<Times New Roman\>\""}]}], "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ByteCount", "[", "equationTp", "]"}], ">", 
                    "equByteLimit"}], ",", 
                    RowBox[{
                    "TextCell", "[", "\"\<Too long to show\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "@", 
                    RowBox[{"MatrixForm", "@", "equationTp"}]}]}], "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}]}], "}"}], 
                    "}"}], "]"}]}], "}"}], "}"}], ",", 
                    RowBox[{"Alignment", "->", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Export\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Export", "[", 
                    RowBox[{
                    RowBox[{"SystemDialogInput", "[", 
                    RowBox[{"\"\<FileSave\>\"", ",", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                    "\"\<equationTs.mx\>\""}], "}"}], "]"}]}], "]"}], ",", 
                    "equationTs", ",", "\"\<mx\>\""}], "]"}]}], ",", 
                    RowBox[{"Method", "->", "\"\<Queued\>\""}]}], "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Copy\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"CopyToClipboard", "[", "equationTs", "]"}], ",", 
                    RowBox[{
                    "Appearance", "\[Rule]", " ", "\"\<DialogBox\>\""}]}], 
                    "]"}], ",", 
                    RowBox[{"TextGrid", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(I\), \(T, 2  \[Omega]\)]\)(\
\[CurlyPhi],\[Psi]+\!\(\*FractionBox[\(\[Pi]\), \(2\)]\))\>\"", ",", "Black", 
                    ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\< = \>\"", ",", "Black", ",", 
                    RowBox[{
                    "FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ByteCount", "[", "equationTs", "]"}], ">", 
                    "equByteLimit"}], ",", 
                    RowBox[{
                    "TextCell", "[", "\"\<Too long to show\>\"", "]"}], ",", 
                    RowBox[{"ExpressionCell", "@", 
                    RowBox[{"MatrixForm", "@", "equationTs"}]}]}], "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}], ",", 
                    RowBox[{"TextCell", "[", "\"\<\>\"", "]"}]}], "}"}], 
                    "}"}], "]"}]}], "}"}], "}"}], ",", 
                    RowBox[{"Alignment", "->", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}]}], 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"FontSize", "\[Rule]", " ", "14"}], "}"}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<\>\"", ",", "30"}], "]"}], ",", 
                    "\[IndentingNewLine]", "timecell", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<\\n\>\"", ",", "30"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1.8", ",", "0.7"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Inset", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<Update\>\"", ",", "Black", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
                    RowBox[{"FontSize", "\[Rule]", 
                    RowBox[{"Scaled", "[", ".27", "]"}]}], ",", 
                    RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
                    RowBox[{"Typeset`update$$", "=", 
                    RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
                    RowBox[{"Appearance", "->", "None"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "->", "Center"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\"\<\>\""}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "]"}]}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "->", 
                    RowBox[{"{", 
                    RowBox[{"800", ",", "Automatic"}], "}"}]}], ",", 
                    RowBox[{"Alignment", "->", 
                    RowBox[{"{", 
                    RowBox[{"Center", ",", "Top"}], "}"}]}], ",", 
                    RowBox[{"Background", "->", "White"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "}"}], "}"}], ",", 
              RowBox[{"Alignment", "->", "Top"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"TrackedSymbols", ":>", 
          RowBox[{"{", 
           RowBox[{
           "schematictype", ",", "materialnumber", ",", "matindex", ",", 
            "Functionality", ",", "\[Lambda]", ",", "mrassumption", ",", 
            "winhAssumption"}], "}"}]}], ",", 
         RowBox[{"ContinuousAction", "->", "None"}], ",", 
         RowBox[{"Paneled", "->", "False"}], ",", 
         RowBox[{"SaveDefinitions", "->", "False"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Background", "->", 
       RowBox[{"GrayLevel", "[", "0.9", "]"}]}], ",", 
      RowBox[{"ImageSize", "->", "Automatic"}], ",", 
      RowBox[{"Alignment", "->", 
       RowBox[{"{", 
        RowBox[{"Left", ",", "Top"}], "}"}]}]}], "]"}]}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8863764175259113`*^9, 3.8863764216510215`*^9}, 
   3.8863766499202127`*^9, 3.8864455607318544`*^9, 3.887895488853596*^9, {
   3.887896034438848*^9, 3.8878960439160757`*^9}, {3.889436106460884*^9, 
   3.8894361315889654`*^9}, {3.8894361873976126`*^9, 3.88943619269838*^9}, {
   3.89102444959268*^9, 3.891024450746577*^9}, {3.89305939105934*^9, 
   3.8930593986154356`*^9}, 3.893059461698475*^9, {3.8930644547510796`*^9, 
   3.893064472349676*^9}, {3.893064510080668*^9, 3.893064522229964*^9}, {
   3.893191509709758*^9, 3.893191517223592*^9}, {3.893192189074219*^9, 
   3.893192204514889*^9}, 3.893193179948883*^9, {3.8931939064949512`*^9, 
   3.8931939312531705`*^9}, 3.8933405442081523`*^9, 3.8933481622867684`*^9, {
   3.8933507093480396`*^9, 3.893350715957938*^9}, {3.894586300088585*^9, 
   3.8945863019774375`*^9}, {3.8945882385294175`*^9, 3.8945882396429615`*^9}, 
   3.895364685360523*^9, 3.895837732757901*^9, {3.8958382367167573`*^9, 
   3.8958382509804587`*^9}, {3.895862888181453*^9, 3.895862899403054*^9}, {
   3.8958714652797155`*^9, 3.8958714808134613`*^9}, {3.895871577983863*^9, 
   3.8958716149822598`*^9}, {3.895881111608961*^9, 3.8958811205978346`*^9}, {
   3.8959239658297596`*^9, 3.895923966325376*^9}, 3.8959423773480606`*^9, {
   3.896314653348934*^9, 3.896314657267294*^9}, 3.8963154455605087`*^9, {
   3.896321435583887*^9, 3.8963214612888904`*^9}, {3.897014237722165*^9, 
   3.897014241214029*^9}, {3.8970165009005947`*^9, 3.897016502144909*^9}, {
   3.8970969729877863`*^9, 3.8970969747356415`*^9}, {3.8971742747549467`*^9, 
   3.8971742987739334`*^9}, {3.8971743546206465`*^9, 
   3.8971743601042366`*^9}, {3.8972624999508963`*^9, 3.89726250567898*^9}, {
   3.897262744722416*^9, 3.8972627684770613`*^9}, {3.8972632772311325`*^9, 
   3.8972632852568636`*^9}, {3.8972633516738973`*^9, 
   3.8972633541172123`*^9}, {3.897263634613264*^9, 3.897263650408495*^9}, {
   3.8972639453176775`*^9, 3.8972639464912057`*^9}, {3.897264054835474*^9, 
   3.897264063685416*^9}, {3.8972641236852856`*^9, 3.8972641640741763`*^9}, {
   3.897264334170711*^9, 3.897264375822837*^9}, {3.897264409445538*^9, 
   3.897264410986657*^9}, 3.8972647577955017`*^9, 3.897265056538562*^9, {
   3.8972652324571233`*^9, 3.8972652945646935`*^9}, 3.897265532269307*^9, {
   3.897265619051794*^9, 3.8972656192213917`*^9}, {3.8972656492230062`*^9, 
   3.8972658770424967`*^9}, 3.8972659621106715`*^9, {3.8972663503638773`*^9, 
   3.897266351160634*^9}, 3.8972688920457516`*^9, {3.8972689951163425`*^9, 
   3.897269022094269*^9}, {3.8972716679316235`*^9, 3.8972716712986555`*^9}, 
   3.8972735227376385`*^9, {3.897273638716218*^9, 3.897273653555581*^9}, {
   3.897608093096344*^9, 3.897608129960377*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"a98b854b-c774-4627-bdc0-c461ecf5096d"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Run",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.895933009888097*^9, 
  3.8959330181481047`*^9}},ExpressionUUID->"55cc25b1-6118-4568-90fc-\
f6cca0bb059f"],

Cell[BoxData["run"], "Input",
 CellChangeTimes->{{3.8971784963421345`*^9, 3.8971784967148747`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"54c5d0bf-aa90-4ef5-b95d-14bc7b0597e7"]
}, Open  ]]
},
WindowSize->{1428., 735.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>0.9 Inherited,
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (August 22, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"97256331-77c7-4948-ab02-08fd8563f608"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 200, 4, 88, "Title",ExpressionUUID->"441924d6-3b8e-4bd4-8fa6-0941648c2c7b"],
Cell[783, 28, 2784, 45, 75, "Input",ExpressionUUID->"0937ff5c-ef37-4c7e-9f0b-71353001cec0",
 InitializationCell->True],
Cell[3570, 75, 373716, 7812, 17370, "Input",ExpressionUUID->"a98b854b-c774-4627-bdc0-c461ecf5096d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[377323, 7892, 189, 4, 65, "Title",ExpressionUUID->"55cc25b1-6118-4568-90fc-f6cca0bb059f"],
Cell[377515, 7898, 178, 2, 25, "Input",ExpressionUUID->"54c5d0bf-aa90-4ef5-b95d-14bc7b0597e7"]
}, Open  ]]
}
]
*)

